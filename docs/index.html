<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi Environment Trials Analysis • metan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><!-- docsearch --><script src="docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Multi Environment Trials Analysis">
<meta property="og:description" content="Performs the most used analyses in the evaluation of
    multi-environment trials. This includes stability analysis using
    widely-known parametric and nonparametric methods, functions for
    biometrical analysis such as path analysis, canonical correlation,
    partial correlation, clustering analysis, as well as tools for
    manipulating, summarizing and plotting typical multi-environment
    trial data.">
<meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">metan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/vignettes_cross-validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="articles/vignettes_ammi.html">AMMI</a>
    </li>
    <li>
      <a href="articles/vignettes_blup.html">BLUP</a>
    </li>
    <li>
      <a href="articles/vignettes_gge.html">GGE</a>
    </li>
    <li>
      <a href="articles/vignettes_stability.html">Stability</a>
    </li>
    <li>
      <a href="articles/vignettes_indexes.html">Multivariate indexes</a>
    </li>
    <li>
      <a href="articles/vignettes_biometry.html">Biometry</a>
    </li>
    <li>
      <a href="articles/vignettes_helper.html">Helper</a>
    </li>
    <li>
      <a href="articles/vignettes_utilities.html">Utilities</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="CODE_OF_CONDUCT.html">Code of Conduct</a>
    </li>
    <li>
      <a href="CONTRIBUTING.html">Contributing</a>
    </li>
    <li>
      <a href="ISSUE_TEMPLATE.html">Issues</a>
    </li>
    <li>
      <a href="SUPPORT.html">Support</a>
    </li>
    <li>
      <a href="LICENSE.html">Licence</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/TiagoOlivoto">Github</a>
</li>
<li>
  <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">ResearchGate</a>
</li>
<li>
  <a href="https://www.mendeley.com/profiles/tiago-olivoto/">Mendeley</a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="metan-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#metan-" class="anchor"></a>metan <img src="reference/figures/logo.png" align="right" height="140/">
</h1></div>
<p>The metan (<strong>m</strong>ulti-<strong>e</strong>nvironment <strong>t</strong>rials <strong>an</strong>alysis) package provides useful functions for analyzing multi-environment trial data using parametric and nonparametric methods, including, but not limited to:</p>
<ul>
<li>Within-environment analysis of variance;</li>
<li>Estimation using AMMI considering different numbers of interaction principal component axes;</li>
<li>AMMI-based stability indexes;</li>
<li>GGE biplot analysis;</li>
<li>Prediction in mixed-effect models;</li>
<li>BLUP-based stability indexes;</li>
<li>Variance components and genetic parameters in mixed-effect models;</li>
<li>Cross-validation procedures for AMMI-family and BLUP models;</li>
<li>Graphics tools for generating biplots;</li>
<li>Parametric and nonparametric stability statistics</li>
</ul>
<p>For more details see the <a href="https://tiagoolivoto.github.io/metan/">complete vignette</a>.</p>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>The latest development version can be download from GitHub by running</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" title="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"TiagoOlivoto/metan"</span>)</a></code></pre></div>
</div>
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<p>Here, we will use the example dataset <code>data_ge</code> that contains data on two variables assessed in 10 genotypes growing in 14 environments. For more details see <code><a href="reference/data_ge.html">?data_ge</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(metan)</a></code></pre></div>
<p>The first step is to inspect the data with the function <code><a href="reference/inspect.html">inspect()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="reference/inspect.html">inspect</a></span>(data_ge,</a>
<a class="sourceLine" id="cb3-2" title="2">        <span class="dt">verbose =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb3-3" title="3">        <span class="dt">plot =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" style="display: block; margin: auto;"></p>
<p>No issues while inspecting the data. Let’s continue with the analyzes!</p>
<div id="ammi-model" class="section level2">
<h2 class="hasAnchor">
<a href="#ammi-model" class="anchor"></a>AMMI model</h2>
<div id="fitting-the-model" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-the-model" class="anchor"></a>Fitting the model</h3>
<p>The AMMI model is fitted with the function <code><a href="reference/performs_ammi.html">performs_ammi()</a></code>. For more details, see the <a href="https://tiagoolivoto.github.io/metan/articles/vignettes_ammi.html">complete vignette</a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">model &lt;-<span class="st"> </span><span class="kw"><a href="reference/performs_ammi.html">performs_ammi</a></span>(data_ge,</a>
<a class="sourceLine" id="cb4-2" title="2">                       <span class="dt">env =</span> ENV,</a>
<a class="sourceLine" id="cb4-3" title="3">                       <span class="dt">gen =</span> GEN,</a>
<a class="sourceLine" id="cb4-4" title="4">                       <span class="dt">rep =</span> REP,</a>
<a class="sourceLine" id="cb4-5" title="5">                       <span class="dt">resp =</span> GY,</a>
<a class="sourceLine" id="cb4-6" title="6">                       <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</div>
<div id="predicting-the-response-variable" class="section level3">
<h3 class="hasAnchor">
<a href="#predicting-the-response-variable" class="anchor"></a>Predicting the response variable</h3>
<p>The S3 method <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> is implemented for objects of class <code>performs_ammi</code> and may be used to estimate the response of each genotype in each environment considering different number of Interaction Principal Component Axis (IPCA). For example, we will use four IPCA (number of significant IPCAs) to estimate the variable GY using the <code>model</code> object. Note that <code>$GY</code> was used because using the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function to a model of class <code>waas</code> return a list, with one <code>tbl_df</code> for each variable.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(model, <span class="dt">naxis =</span> <span class="dv">4</span>)<span class="op">$</span>GY</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt; # A tibble: 140 x 8</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt;    ENV   GEN       Y  resOLS Ypred ResAMMI[,1] YpredAMMI[,1] AMMI0</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt;    &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt;  1 E1    G1     2.37 -0.0843  2.45     0.0712           2.52  2.45</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt;  2 E1    G10    1.97 -0.344   2.32    -0.354            1.96  2.32</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt;  3 E1    G2     2.90  0.311   2.59     0.290            2.88  2.59</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt;  4 E1    G3     2.89  0.0868  2.80    -0.0452           2.76  2.80</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt;  5 E1    G4     2.59  0.100   2.49     0.0494           2.54  2.49</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt;  6 E1    G5     2.19 -0.196   2.38    -0.0709           2.31  2.38</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt;  7 E1    G6     2.30 -0.0797  2.38    -0.0829           2.30  2.38</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt;  8 E1    G7     2.77  0.186   2.59     0.164            2.75  2.59</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt;  9 E1    G8     2.90  0.0493  2.85    -0.00536          2.84  2.85</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt; 10 E1    G9     2.33 -0.0307  2.36    -0.0170           2.34  2.36</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt; # … with 130 more rows</span></a></code></pre></div>
</div>
<div id="biplots" class="section level3">
<h3 class="hasAnchor">
<a href="#biplots" class="anchor"></a>Biplots</h3>
<p>ggplot2-based graphics are easily obtained in metan package. For example, the well-known AMMI2 biplot may be obtained as follows. Please, note that since <code><a href="reference/waas.html">waas()</a></code> function allows analyzing multiple variables at the same time, e.g., <code>resp = c(v1, v2, ...)</code>, the output <code>model</code> is a list, in this case with one element, GY.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">a &lt;-<span class="st"> </span><span class="kw"><a href="reference/plot_scores.html">plot_scores</a></span>(model)</a>
<a class="sourceLine" id="cb6-2" title="2">b &lt;-<span class="st"> </span><span class="kw"><a href="reference/plot_scores.html">plot_scores</a></span>(model,</a>
<a class="sourceLine" id="cb6-3" title="3">                 <span class="dt">type =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb6-4" title="4">                 <span class="dt">polygon =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-5" title="5">                 <span class="dt">col.env =</span> <span class="st">"gray70"</span>,</a>
<a class="sourceLine" id="cb6-6" title="6">                 <span class="dt">col.segm.env =</span> <span class="st">"gray70"</span>,</a>
<a class="sourceLine" id="cb6-7" title="7">                 <span class="dt">axis.expand =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb6-8" title="8">c &lt;-<span class="st"> </span><span class="kw"><a href="reference/plot_scores.html">plot_scores</a></span>(model, <span class="dt">type =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb6-9" title="9"><span class="kw"><a href="reference/arrange_ggplot.html">arrange_ggplot</a></span>(a, b, c, <span class="dt">labels =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">nrow =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="reference/figures/README-AMMI-1.png"><!-- --></p>
</div>
</div>
<div id="gge-model" class="section level2">
<h2 class="hasAnchor">
<a href="#gge-model" class="anchor"></a>GGE model</h2>
<p>The GGE model is fitted with the function <code><a href="reference/gge.html">gge()</a></code>. For more details, see the <a href="https://tiagoolivoto.github.io/metan/articles/vignettes_gge.html">complete vignette</a>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">model &lt;-<span class="st"> </span><span class="kw"><a href="reference/gge.html">gge</a></span>(data_ge, ENV, GEN, GY)</a>
<a class="sourceLine" id="cb7-2" title="2">model2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/gge.html">gge</a></span>(data_ge, ENV, GEN, GY, <span class="dt">svp =</span> <span class="st">"genotype"</span>)</a>
<a class="sourceLine" id="cb7-3" title="3">model3 &lt;-<span class="st"> </span><span class="kw"><a href="reference/gge.html">gge</a></span>(data_ge, ENV, GEN, GY, <span class="dt">svp =</span> <span class="st">"symmetrical"</span>)</a>
<a class="sourceLine" id="cb7-4" title="4">d &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(model)</a>
<a class="sourceLine" id="cb7-5" title="5">e &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(model2, <span class="dt">type =</span> <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb7-6" title="6">f &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(model2,</a>
<a class="sourceLine" id="cb7-7" title="7">          <span class="dt">type =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb7-8" title="8">          <span class="dt">col.gen =</span> <span class="st">"black"</span>,</a>
<a class="sourceLine" id="cb7-9" title="9">          <span class="dt">col.env =</span> <span class="st">"gray70"</span>,</a>
<a class="sourceLine" id="cb7-10" title="10">          <span class="dt">axis.expand =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb7-11" title="11"><span class="kw"><a href="reference/arrange_ggplot.html">arrange_ggplot</a></span>(d, e, f, <span class="dt">labels =</span> letters[<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">nrow =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="reference/figures/README-GGE-1.png"><!-- --></p>
</div>
<div id="blup-model" class="section level2">
<h2 class="hasAnchor">
<a href="#blup-model" class="anchor"></a>BLUP model</h2>
<p>Linear-mixed effect models to predict the response variable in METs are fitted using the function <code><a href="reference/waasb.html">waasb()</a></code>. Here we will obtain the predicted means for genotypes in the variables <code>GY</code> and <code>HM</code>. For more details, see the <a href="https://tiagoolivoto.github.io/metan/articles/vignettes_blup.html">complete vignette</a>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">model2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/waasb.html">waasb</a></span>(data_ge, ENV, GEN, REP,</a>
<a class="sourceLine" id="cb8-2" title="2">                <span class="dt">resp =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(GY, HM),</a>
<a class="sourceLine" id="cb8-3" title="3">                <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="kw"><a href="reference/get_model_data.html">get_model_data</a></span>(model2, <span class="dt">what =</span> <span class="st">"genpar"</span>)</a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; # A tibble: 15 x 3</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt;    Parameters                 GY      HM</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt;    &lt;chr&gt;                   &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt;  1 GEI variance           0.0567  2.19  </span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt;  2 GEI (%)               31.3    39.7   </span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt;  3 Genotypic variance     0.0280  0.490 </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt;  4 Gen (%)               15.4     8.88  </span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt;  5 Residual variance      0.0967  2.84  </span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt;  6 Res (%)               53.3    51.5   </span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">#&gt;  7 Phenotypic variance    0.181   5.52  </span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt;  8 Heritability           0.154   0.0888</span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">#&gt;  9 GEIr2                  0.313   0.397 </span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">#&gt; 10 Heribatility of means  0.815   0.686 </span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">#&gt; 11 Accuracy               0.903   0.828 </span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">#&gt; 12 rge                    0.370   0.435 </span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">#&gt; 13 CVg                    6.26    1.46  </span></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="co">#&gt; 14 CVr                   11.6     3.50  </span></a>
<a class="sourceLine" id="cb8-23" title="23"><span class="co">#&gt; 15 CV ratio               0.538   0.415</span></a>
<a class="sourceLine" id="cb8-24" title="24"><span class="kw"><a href="reference/get_model_data.html">get_model_data</a></span>(model2, <span class="dt">what =</span> <span class="st">"blupg"</span>)</a>
<a class="sourceLine" id="cb8-25" title="25"><span class="co">#&gt; # A tibble: 10 x 3</span></a>
<a class="sourceLine" id="cb8-26" title="26"><span class="co">#&gt;    gen      GY    HM</span></a>
<a class="sourceLine" id="cb8-27" title="27"><span class="co">#&gt;    &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb8-28" title="28"><span class="co">#&gt;  1 G1     2.62  47.4</span></a>
<a class="sourceLine" id="cb8-29" title="29"><span class="co">#&gt;  2 G10    2.51  48.4</span></a>
<a class="sourceLine" id="cb8-30" title="30"><span class="co">#&gt;  3 G2     2.73  47.1</span></a>
<a class="sourceLine" id="cb8-31" title="31"><span class="co">#&gt;  4 G3     2.90  47.8</span></a>
<a class="sourceLine" id="cb8-32" title="32"><span class="co">#&gt;  5 G4     2.65  48.0</span></a>
<a class="sourceLine" id="cb8-33" title="33"><span class="co">#&gt;  6 G5     2.56  48.9</span></a>
<a class="sourceLine" id="cb8-34" title="34"><span class="co">#&gt;  7 G6     2.56  48.5</span></a>
<a class="sourceLine" id="cb8-35" title="35"><span class="co">#&gt;  8 G7     2.73  48.0</span></a>
<a class="sourceLine" id="cb8-36" title="36"><span class="co">#&gt;  9 G8     2.94  48.8</span></a>
<a class="sourceLine" id="cb8-37" title="37"><span class="co">#&gt; 10 G9     2.54  48.0</span></a></code></pre></div>
<div id="plotting-the-blups-for-genotypes" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-the-blups-for-genotypes" class="anchor"></a>Plotting the BLUPs for genotypes</h3>
<p>To produce a plot with the predicted means, use the function <code><a href="reference/plot_blup.html">plot_blup()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">g &lt;-<span class="st"> </span><span class="kw"><a href="reference/plot_blup.html">plot_blup</a></span>(model2)</a>
<a class="sourceLine" id="cb9-2" title="2">h &lt;-<span class="st"> </span><span class="kw"><a href="reference/plot_blup.html">plot_blup</a></span>(model2,</a>
<a class="sourceLine" id="cb9-3" title="3">               <span class="dt">prob =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb9-4" title="4">               <span class="dt">col.shape  =</span>  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gray20"</span>, <span class="st">"gray80"</span>)) <span class="op">+</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>()</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="kw"><a href="reference/arrange_ggplot.html">arrange_ggplot</a></span>(g, h, <span class="dt">labels =</span> letters[<span class="dv">7</span><span class="op">:</span><span class="dv">8</span>])</a></code></pre></div>
<p><img src="reference/figures/README-BLUP-1.png"><!-- --></p>
</div>
<div id="blups-for-genotype-vs-environment-interaction" class="section level3">
<h3 class="hasAnchor">
<a href="#blups-for-genotype-vs-environment-interaction" class="anchor"></a>BLUPS for genotype-vs-environment interaction</h3>
<p>The object <code>BLUPgge</code> contains the blups for the genotype-vs-environment interaction. In the following example, the values for <code>GY</code> are shown.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">model2<span class="op">$</span>GY<span class="op">$</span>BLUPgge</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt; # A tibble: 140 x 8</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt;    ENV   GEN    BLUPge   BLUPg `BLUPg+ge` Predicted    LL    UL</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt;    &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt;  1 E1    G1    -0.0621 -0.0575    -0.120       2.40  2.30  2.50</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt;  2 E1    G10   -0.243  -0.166     -0.409       2.11  2.01  2.22</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt;  3 E1    G2     0.207   0.0570     0.264       2.78  2.68  2.89</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt;  4 E1    G3     0.0885  0.229      0.318       2.84  2.73  2.94</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt;  5 E1    G4     0.0601 -0.0264     0.0337      2.55  2.45  2.66</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">#&gt;  6 E1    G5    -0.141  -0.112     -0.252       2.27  2.16  2.37</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt;  7 E1    G6    -0.0673 -0.114     -0.182       2.34  2.24  2.44</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt;  8 E1    G7     0.127   0.0543     0.181       2.70  2.60  2.81</span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt;  9 E1    G8     0.0702  0.269      0.339       2.86  2.76  2.96</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">#&gt; 10 E1    G9    -0.0389 -0.134     -0.173       2.35  2.24  2.45</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">#&gt; # … with 130 more rows</span></a></code></pre></div>
<p>When more than one variable is fitted, the predicted means for genotype-vs-environment combination may be obtained for all variables in the model using <code><a href="reference/get_model_data.html">get_model_data()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="reference/get_model_data.html">get_model_data</a></span>(model2, <span class="dt">what =</span> <span class="st">"blupge"</span>)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">#&gt; # A tibble: 140 x 4</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">#&gt;    ENV   GEN      GY    HM</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt;    &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#&gt;  1 E1    G1     2.40  46.6</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt;  2 E1    G10    2.11  47.2</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&gt;  3 E1    G2     2.78  45.7</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#&gt;  4 E1    G3     2.84  46.2</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co">#&gt;  5 E1    G4     2.55  48.0</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">#&gt;  6 E1    G5     2.27  49.4</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">#&gt;  7 E1    G6     2.34  48.1</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co">#&gt;  8 E1    G7     2.70  47.4</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co">#&gt;  9 E1    G8     2.86  48.0</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co">#&gt; 10 E1    G9     2.35  47.6</span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co">#&gt; # … with 130 more rows</span></a></code></pre></div>
</div>
</div>
</div>
<div id="computing-parametric-and-non-parametric-stability-indexes" class="section level1">
<h1 class="hasAnchor">
<a href="#computing-parametric-and-non-parametric-stability-indexes" class="anchor"></a>Computing parametric and non-parametric stability indexes</h1>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">stats &lt;-<span class="st"> </span><span class="kw"><a href="reference/ge_stats.html">ge_stats</a></span>(data_ge, ENV, GEN, REP, GY)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw"><a href="reference/get_model_data.html">get_model_data</a></span>(stats, <span class="st">"stats"</span>)</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">#&gt; # A tibble: 10 x 32</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">#&gt;    var   gen       Y   Var Shukla  Wi_g  Wi_f  Wi_u Ecoval   bij      Sij    R2</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">#&gt;  1 GY    G1     2.60 10.9  0.0280  84.4  89.2  81.1  1.22  1.06  -0.00142 0.966</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">#&gt;  2 GY    G10    2.47 14.2  0.244   59.2  64.6  54.4  7.96  1.12   0.177   0.823</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co">#&gt;  3 GY    G2     2.74 11.3  0.0861  82.8  95.3  75.6  3.03  1.05   0.0497  0.913</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="co">#&gt;  4 GY    G3     2.96 10.1  0.0121 104.   99.7 107.   0.725 1.03  -0.0128  0.977</span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co">#&gt;  5 GY    G4     2.64  8.93 0.0640  85.9  79.5  91.9  2.34  0.937  0.0298  0.917</span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co">#&gt;  6 GY    G5     2.54  7.82 0.0480  82.7  82.2  82.4  1.84  0.887  0.00902 0.937</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="co">#&gt;  7 GY    G6     2.53  7.34 0.0468  83.0  83.7  81.8  1.81  0.861  0.00304 0.942</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="co">#&gt;  8 GY    G7     2.74  7.33 0.122   83.9  77.6  93.4  4.16  0.819  0.0579  0.852</span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">#&gt;  9 GY    G8     3.00 10.8  0.0712  98.8  90.5 107.   2.57  1.03   0.0382  0.922</span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co">#&gt; 10 GY    G9     2.51 14.7  0.167   68.8  68.9  70.3  5.56  1.19   0.0938  0.897</span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="co">#&gt; # … with 20 more variables: ASV &lt;dbl&gt;, SIPC &lt;dbl&gt;, EV &lt;dbl&gt;, ZA &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="co">#&gt; #   WAAS &lt;dbl&gt;, HMGV &lt;dbl&gt;, RPGV &lt;dbl&gt;, HMRPGV &lt;dbl&gt;, Pi_a &lt;dbl&gt;, Pi_f &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-18" title="18"><span class="co">#&gt; #   Pi_u &lt;dbl&gt;, Gai &lt;dbl&gt;, S1 &lt;dbl&gt;, S2 &lt;dbl&gt;, S3 &lt;dbl&gt;, S6 &lt;dbl&gt;, N1 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-19" title="19"><span class="co">#&gt; #   N2 &lt;dbl&gt;, N3 &lt;dbl&gt;, N4 &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb12-20" title="20"><span class="kw"><a href="reference/get_model_data.html">get_model_data</a></span>(stats, <span class="st">"ranks"</span>)</a>
<a class="sourceLine" id="cb12-21" title="21"><span class="co">#&gt; # A tibble: 10 x 31</span></a>
<a class="sourceLine" id="cb12-22" title="22"><span class="co">#&gt;    var   gen     Y_R Var_R Shukla_R Wi_g_R Wi_f_R Wi_u_R Ecoval_R Sij_R  R2_R</span></a>
<a class="sourceLine" id="cb12-23" title="23"><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb12-24" title="24"><span class="co">#&gt;  1 GY    G1        6     7        2      4      4      7        2     1     2</span></a>
<a class="sourceLine" id="cb12-25" title="25"><span class="co">#&gt;  2 GY    G10      10     9       10     10     10     10       10    10    10</span></a>
<a class="sourceLine" id="cb12-26" title="26"><span class="co">#&gt;  3 GY    G2        3     8        7      7      2      8        7     7     7</span></a>
<a class="sourceLine" id="cb12-27" title="27"><span class="co">#&gt;  4 GY    G3        2     5        1      1      1      2        1     4     1</span></a>
<a class="sourceLine" id="cb12-28" title="28"><span class="co">#&gt;  5 GY    G4        5     4        5      3      7      4        5     5     6</span></a>
<a class="sourceLine" id="cb12-29" title="29"><span class="co">#&gt;  6 GY    G5        7     3        4      8      6      5        4     3     4</span></a>
<a class="sourceLine" id="cb12-30" title="30"><span class="co">#&gt;  7 GY    G6        8     2        3      6      5      6        3     2     3</span></a>
<a class="sourceLine" id="cb12-31" title="31"><span class="co">#&gt;  8 GY    G7        4     1        8      5      8      3        8     8     9</span></a>
<a class="sourceLine" id="cb12-32" title="32"><span class="co">#&gt;  9 GY    G8        1     6        6      2      3      1        6     6     5</span></a>
<a class="sourceLine" id="cb12-33" title="33"><span class="co">#&gt; 10 GY    G9        9    10        9      9      9      9        9     9     8</span></a>
<a class="sourceLine" id="cb12-34" title="34"><span class="co">#&gt; # … with 20 more variables: ASV_R &lt;dbl&gt;, SIPC_R &lt;dbl&gt;, EV_R &lt;dbl&gt;, ZA_R &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-35" title="35"><span class="co">#&gt; #   WAAS_R &lt;dbl&gt;, HMGV_R &lt;dbl&gt;, RPGV_R &lt;dbl&gt;, HMRPGV_R &lt;dbl&gt;, Pi_a_R &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-36" title="36"><span class="co">#&gt; #   Pi_f_R &lt;dbl&gt;, Pi_u_R &lt;dbl&gt;, Gai_R &lt;dbl&gt;, S1_R &lt;dbl&gt;, S2_R &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-37" title="37"><span class="co">#&gt; #   S3_R &lt;dbl&gt;, S6_R &lt;dbl&gt;, N1_R &lt;dbl&gt;, N2_R &lt;dbl&gt;, N3_R &lt;dbl&gt;, N4_R &lt;dbl&gt;</span></a></code></pre></div>
</div>
<div id="getting-help" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-help" class="anchor"></a>Getting help</h1>
<ul>
<li><p>If you encounter a clear bug, please file a minimal reproducible example on <a href="https://github.com/TiagoOlivoto/metan/issues">github</a></p></li>
<li><p>Suggestions and criticisms to improve the quality and usability of the package are welcome!</p></li>
</ul>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/TiagoOlivoto/metan">https://​github.com/​TiagoOlivoto/​metan</a>
</li>
<li>Report a bug at <br><a href="https://github.com/TiagoOlivoto/metan/issues">https://​github.com/​TiagoOlivoto/​metan/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.researchgate.net/profile/Tiago_Olivoto2">Tiago Olivoto</a> <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-0241-9636" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'ef40e3bab94bb0e1d687fd3844052701',
    indexName: 'metan',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
