<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyzing multienvironment trials using BLUP • metan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Analyzing multienvironment trials using BLUP">
<meta property="og:description" content="">
<meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="../articles/vignettes_ammi.html">AMMI</a>
    </li>
    <li>
      <a href="../articles/vignettes_blup.html">BLUP</a>
    </li>
    <li>
      <a href="../articles/vignettes_descriptive.html">Descriptive statistics</a>
    </li>
    <li>
      <a href="../articles/vignettes_gge.html">GGE</a>
    </li>
    <li>
      <a href="../articles/vignettes_stability.html">Stability</a>
    </li>
    <li>
      <a href="../articles/vignettes_indexes.html">Multivariate indexes</a>
    </li>
    <li>
      <a href="../articles/vignettes_biometry.html">Biometry</a>
    </li>
    <li>
      <a href="../articles/vignettes_helper.html">Helper</a>
    </li>
    <li>
      <a href="../articles/vignettes_utilities.html">Utilities</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    </li>
    <li>
      <a href="../CONTRIBUTING.html">Contributing</a>
    </li>
    <li>
      <a href="../ISSUE_TEMPLATE.html">Issues</a>
    </li>
    <li>
      <a href="../SUPPORT.html">Support</a>
    </li>
    <li>
      <a href="../LICENSE.html">Licence</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/TiagoOlivoto">Github</a>
</li>
<li>
  <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">ResearchGate</a>
</li>
<li>
  <a href="https://www.mendeley.com/profiles/tiago-olivoto/">Mendeley</a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignettes_blup_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="vignettes_blup_files/jquery-1.12.4/jquery.min.js"></script><link href="vignettes_blup_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="vignettes_blup_files/datatables-binding-0.12/datatables.js"></script><link href="vignettes_blup_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="vignettes_blup_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="vignettes_blup_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script src="vignettes_blup_files/jszip-1.10.20/jszip.min.js"></script><script src="vignettes_blup_files/pdfmake-1.10.20/pdfmake.min.js"></script><script src="vignettes_blup_files/pdfmake-1.10.20/vfs_fonts.js"></script><link href="vignettes_blup_files/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="vignettes_blup_files/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script><script src="vignettes_blup_files/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script><script src="vignettes_blup_files/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script><script src="vignettes_blup_files/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script><script src="vignettes_blup_files/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script><link href="vignettes_blup_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet">
<script src="vignettes_blup_files/crosstalk-1.0.0/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Analyzing multienvironment trials using BLUP</h1>
                        <h4 class="author">Tiago Olivoto</h4>
            
            <h4 class="date">2020-03-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/master/vignettes/vignettes_blup.Rmd"><code>vignettes/vignettes_blup.Rmd</code></a></small>
      <div class="hidden name"><code>vignettes_blup.Rmd</code></div>

    </div>

    
    
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<p>In this section, we will use the data in <code>data_ge</code>. For more information, please, see <code><a href="../reference/data_ge.html">?data_ge</a></code>. Other data sets can be used provided that the following columns are in the dataset: environment, genotype, block/replicate and response variable(s).</p>
<p>The first step is to inspect the data with the function <code><a href="../reference/inspect.html">inspect()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(metan)</a>
<a class="sourceLine" id="cb1-2" title="2">inspect &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="../reference/inspect.html">inspect</a></span>(data_ge,</a>
<a class="sourceLine" id="cb1-4" title="4">        <span class="dt">verbose =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb1-5" title="5">        <span class="dt">plot =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">print_table</span>(inspect)</a></code></pre></div>
<div id="htmlwidget-d0c42bf11f9bc93f42b6" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d0c42bf11f9bc93f42b6">{"x":{"filter":"none","extensions":["Buttons"],"data":[["ENV","GEN","REP","GY","HM"],["factor","factor","factor","numeric","numeric"],["No","No","No","No","No"],["14","10","3","-","-"],[420,420,420,420,420],[null,null,null,0.67,38],[null,null,null,2.61,48],[null,null,null,5.09,58],[null,null,null,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Class<\/th>\n      <th>Missing<\/th>\n      <th>Levels<\/th>\n      <th>Valid_n<\/th>\n      <th>Min<\/th>\n      <th>Median<\/th>\n      <th>Max<\/th>\n      <th>Outlier<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 5, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 6, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 7, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 8, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<div id="analysis-of-single-experiments-using-mixed-models" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis-of-single-experiments-using-mixed-models" class="anchor"></a>Analysis of single experiments using mixed-models</h1>
<p>The function <code><a href="../reference/gamem.html">gamem()</a></code> may be used to analyze single experiments (one-way experiments) using a mixed-effect model according to the following model:</p>
<p><span class="math display">\[
y_{ij}= \mu  + \alpha_i + \tau_j + \varepsilon_{ij}
\]</span> where <span class="math inline">\(y_{ij}\)</span> is the value observed for the <em>i</em>th genotype in the <em>j</em>th replicate (<em>i</em> = 1, 2, … <em>g</em>; <em>j</em> = 1, 2, .., <em>r</em>); being <em>g</em> and <em>r</em> the number of genotypes and replicates, respectively; <span class="math inline">\(\alpha_i\)</span> is the random effect of the <em>i</em>th genotype; <span class="math inline">\(\tau_j\)</span> is the fixed effect of the <em>j</em>th replicate; and <span class="math inline">\(\varepsilon_{ij}\)</span> is the random error associated to <span class="math inline">\(y_{ij}\)</span>. In this example, we will use the example data <code>data_g</code> from metan package.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">gen_mod &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gamem.html">gamem</a></span>(data_g, GEN, REP,</a>
<a class="sourceLine" id="cb3-2" title="2">                 <span class="dt">resp =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(ED, CL, CD, KW, TKW, NKR))</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co"># Model:  Y ~ REP + (1 | GEN) </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#     model       ED       CL    CD     KW     TKW   NKR</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#  Complete       NA       NA    NA     NA      NA    NA</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#  Genotype 2.73e-05 2.25e-06 0.118 0.0253 0.00955 0.216</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co"># Variables with nonsignificant Genotype effect</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co"># CD NKR </span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co"># ---------------------------------------------------------------------------</span></a></code></pre></div>
<p>The easiest way of obtaining the results of the model above is by using the function <code><a href="../reference/get_model_data.html">get_model_data()</a></code>. Let’s do it.</p>
<ul>
<li>Details of the analysis</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(gen_mod, <span class="st">"details"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print_table</span>()</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co"># Class of the model: gamem</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co"># Variable extracted: details</span></a></code></pre></div>
<div id="htmlwidget-9066967e8b9eb8f39196" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9066967e8b9eb8f39196">{"x":{"filter":"none","extensions":["Buttons"],"data":[["Ngen","OVmean","Min","Max","MinGEN","MaxGEN"],["13","47.8727","43.482 (H9 in 1)","52.64 (H1 in 3)","43.8547 (H9)","50.6753 (H13)"],["13","28.4487","23.492 (H10 in 2)","33.16 (H6 in 1)","24.7773 (H10)","31.9033 (H6)"],["13","15.7703","14 (H6 in 1)","17.56 (H9 in 3)","14.6533 (H12)","16.6733 (H2)"],["13","146.8108","114.1174 (H11 in 2)","199.139 (H13 in 1)","120.5581 (H10)","181.6017 (H13)"],["13","317.7178","232.5912 (H10 in 2)","422.1651 (H1 in 3)","247.2608 (H10)","368.7677 (H1)"],["13","30.4","24.8 (H1 in 2)","36.2 (H5 in 3)","26.4 (H6)","33.5333 (H4)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Parameters<\/th>\n      <th>ED<\/th>\n      <th>CL<\/th>\n      <th>CD<\/th>\n      <th>KW<\/th>\n      <th>TKW<\/th>\n      <th>NKR<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 5, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 6, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><ul>
<li>Likelihood ratio test for genotype effect</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(gen_mod, <span class="st">"pval_lrt"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print_table</span>()</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co"># Class of the model: gamem</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co"># Variable extracted: pval_lrt</span></a></code></pre></div>
<div id="htmlwidget-4ed92dd6f627c0577d57" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4ed92dd6f627c0577d57">{"x":{"filter":"none","extensions":["Buttons"],"data":[["Complete","Genotype"],[null,2.73247970370529e-005],[null,2.25168687359724e-006],[null,0.117627368552794],[null,0.0253199201214281],[null,0.00955250501495603],[null,0.21617419426101]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>model<\/th>\n      <th>ED<\/th>\n      <th>CL<\/th>\n      <th>CD<\/th>\n      <th>KW<\/th>\n      <th>TKW<\/th>\n      <th>NKR<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 5, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 6, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><ul>
<li>Variance components and genetic parameters</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(gen_mod, <span class="st">"genpar"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print_table</span>()</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co"># Class of the model: gamem</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co"># Variable extracted: genpar</span></a></code></pre></div>
<div id="htmlwidget-3c8ae86eb855bd07b03c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3c8ae86eb855bd07b03c">{"x":{"filter":"none","extensions":["Buttons"],"data":[["Gen_var","Gen (%)","Res_var","Res (%)","Phen_var","H2","H2mg","Accuracy","CVg","CVr","CV ratio"],[5.36879317159502,68.839440875941,2.43021434979144,31.160559124059,7.79900752138646,0.68839440875941,0.868896391238544,0.93214612118409,4.84005968229223,3.2563769402656,1.48633274681569],[4.26904834321885,75.1059841136283,1.41498388617073,24.8940158863717,5.68403222938958,0.751059841136283,0.90050829277774,0.948951154052589,7.26279222101131,4.18132408842867,1.73695988816324],[0.239629962398869,27.4413913939002,0.633612793258686,72.5586086060998,0.873242755657556,0.274413913939002,0.531525665409112,0.729058067240952,3.10407213484755,5.04746381419023,0.614976599955188],[180.971887275685,39.2239674045783,280.408996022117,60.7760325954217,461.380883297802,0.392239674045783,0.659418683323965,0.812045985966291,9.16320706707493,11.4061194186855,0.803358857707886],[840.939331867264,45.2271153988567,1018.43048301269,54.7728846011433,1859.36981487995,0.452271153988567,0.712409199986116,0.844043363806692,9.12726745100436,10.0444032241996,0.908691860260484],[2.14666666693819,21.5865921812921,7.79777777760266,78.4134078187079,9.94444444454086,0.215865921812921,0.452317777467832,0.672545743773487,4.81957477570742,9.18569124600464,0.524682862359838]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Parameters<\/th>\n      <th>ED<\/th>\n      <th>CL<\/th>\n      <th>CD<\/th>\n      <th>KW<\/th>\n      <th>TKW<\/th>\n      <th>NKR<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 5, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 6, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><ul>
<li>Predicted means</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(gen_mod, <span class="st">"blupg"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print_table</span>()</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co"># Class of the model: gamem</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co"># Variable extracted: blupg</span></a></code></pre></div>
<div id="htmlwidget-e1f4c31a5b875e02bbd5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e1f4c31a5b875e02bbd5">{"x":{"filter":"none","extensions":["Buttons"],"data":[["H1","H10","H11","H12","H13","H2","H3","H4","H5","H6","H7","H8","H9"],[50.2337477937922,44.39534330893,47.1555375117645,47.7573930787624,50.3078936191779,50.2731377635284,47.176970289415,46.0879534790627,49.8311591325184,49.7187818659182,48.6813195747794,46.3439882823477,44.3814409666702],[30.6543116451104,25.1426005544488,26.5563985741098,26.0881342618654,27.3986739972879,29.975328392356,28.5573280006619,27.7558756200898,30.0989981978974,31.5596226487829,30.0455680391926,28.9757641873727,27.0240625474924],[15.7896093960226,15.4565199790329,15.5699121209868,15.1765831285841,15.8888275202323,16.2502649727105,16.1120682997041,16.1900253972975,16.165220866245,15.2368227039971,15.5380205810623,15.810870422639,15.8285879448193],[153.408766122495,129.499293404642,142.791295376625,147.833486508116,169.752549562129,155.710874733229,141.651473323362,144.597488804003,156.244921813057,140.385685772155,152.64309398789,143.263053613761,130.758644611868],[354.086196396221,267.523552821644,296.995914448496,293.435610757655,319.077894447563,337.814450282329,330.780319686164,309.888985625008,309.011800906594,325.070085809127,346.447888092865,339.121929099244,301.076861842404],[29.4953644450643,31.7267988139056,31.3046355549357,30.0381457780257,31.1538629624464,29.6461370375536,30.188918370515,31.8172623693992,31.2744810364378,28.5907288901287,30.0381457780257,29.5255189635622,30.4]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>gen<\/th>\n      <th>ED<\/th>\n      <th>CL<\/th>\n      <th>CD<\/th>\n      <th>KW<\/th>\n      <th>TKW<\/th>\n      <th>NKR<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 5, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 6, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><p>In the above example, the experimental design was a complete randomized block. It is also possible to analyze an experiment conducted in an alpha-lattice design with the function <code><a href="../reference/gamem.html">gamem()</a></code>. In this case, the following model is fitted:</p>
<p><span class="math display">\[
y_{ijk}= \mu  + \alpha_i + \gamma_j + (\gamma \tau)_{jk} + \varepsilon_{ijk}
\]</span></p>
<p>where <span class="math inline">\(y_{ijk}\)</span> is the observed value of the <em>i</em>th genotype in the <em>k</em>th block of the <em>j</em>th replicate (<em>i</em> = 1, 2, … <em>g</em>; <em>j</em> = 1, 2, .., <em>r</em>; <em>k</em> = 1, 2, .., <em>b</em>); respectively; <span class="math inline">\(\alpha_i\)</span> is the random effect of the <em>i</em>th genotype; <span class="math inline">\(\gamma_j\)</span> is the fixed effect of the <em>j</em>th complete replicate; <span class="math inline">\((\gamma \tau)_{jk}\)</span> is the random effect of the <em>k</em>th incomplete block nested within the <em>j</em> replicate; and <span class="math inline">\(\varepsilon_{ijk}\)</span> is the random error associated to <span class="math inline">\(y_{ijk}\)</span>. In this example, we will use the example data <code>data_alpha</code> from metan package.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">gen_alpha &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gamem.html">gamem</a></span>(data_alpha, GEN, REP, YIELD, <span class="dt">block =</span> BLOCK)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co"># Model:  Y ~ (1 | GEN) + REP + (1 | REP:BLOCK) </span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#      model    YIELD</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#   Complete       NA</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#   Genotype 1.18e-06</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#  rep:block 3.35e-03</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co"># All variables with significant (p &lt; 0.05) genotype effect</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(gen_alpha, <span class="st">"pval_lrt"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print_table</span>()</a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co"># Class of the model: gamem</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co"># Variable extracted: pval_lrt</span></a></code></pre></div>
<div id="htmlwidget-1b7490ef5fb076842f3d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1b7490ef5fb076842f3d">{"x":{"filter":"none","extensions":["Buttons"],"data":[["Complete","Genotype","rep:block"],[null,1.17578885889374e-006,0.00335094391888557]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>model<\/th>\n      <th>YIELD<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":1}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(gen_alpha, <span class="st">"details"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print_table</span>()</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co"># Class of the model: gamem</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co"># Variable extracted: details</span></a></code></pre></div>
<div id="htmlwidget-34a65ed21a33c3e43cfe" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-34a65ed21a33c3e43cfe">{"x":{"filter":"none","extensions":["Buttons"],"data":[["Ngen","OVmean","Min","Max","MinGEN","MaxGEN"],["24","4.4795","2.8873 (G03 in B6 of R3)","5.8757 (G05 in B1 of R1)","3.3431 (G03)","5.1625 (G01)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Parameters<\/th>\n      <th>YIELD<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(gen_alpha, <span class="st">"genpar"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print_table</span>()</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co"># Class of the model: gamem</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co"># Variable extracted: genpar</span></a></code></pre></div>
<div id="htmlwidget-6f2b49b753c5184d52bc" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6f2b49b753c5184d52bc">{"x":{"filter":"none","extensions":["Buttons"],"data":[["Gen_var","Gen (%)","rep:block_var","rep:block (%)","Res_var","Res (%)","Phen_var","H2","H2mg","Accuracy","CVg","CVr","CV ratio"],[0.142902103629106,48.4845225246682,0.0702183318353477,23.8240180169197,0.0816171347702526,27.6914594584121,0.294737570234706,0.484845225246682,0.797996761986597,0.893306644991851,8.43894495702758,6.37763287142582,1.32320958687309]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Parameters<\/th>\n      <th>YIELD<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":1}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<div id="the-blup-model-for-met-trials" class="section level1">
<h1 class="hasAnchor">
<a href="#the-blup-model-for-met-trials" class="anchor"></a>The BLUP model for MET trials</h1>
<p>The simplest and well-known linear model with interaction effect used to analyze data from multi-environment trials is <span class="math display">\[
    {y_{ijk}} = {\rm{ }}\mu {\rm{ }} + \mathop \alpha \nolimits_i  + \mathop \tau \nolimits_j  + \mathop {(\alpha \tau )}\nolimits_{ij}  + \mathop \gamma \nolimits_{jk}  + {\rm{ }}\mathop \varepsilon \nolimits_{ijk}
    \]</span></p>
<p>where <span class="math inline">\({y_{ijk}}\)</span> is the response variable (e.g., grain yield) observed in the <em>k</em>th block of the <em>i</em>th genotype in the <em>j</em>th environment (<em>i</em> = 1, 2, …, <em>g</em>; <em>j</em> = 1, 2, …, <em>e</em>; <em>k</em> = 1, 2, …, <em>b</em>); <span class="math inline">\(\mu\)</span> is the grand mean; <span class="math inline">\(\mathop \alpha \nolimits_i\)</span> is the effect of the ith genotype; <span class="math inline">\(\mathop \tau \nolimits_j\)</span> is the effect of the <em>j</em>th environment; <span class="math inline">\(\mathop {(\alpha \tau )}\nolimits_{ij}\)</span> is the interaction effect of the <em>i</em>th genotype with the <em>j</em>th environment; <span class="math inline">\(\mathop \gamma \nolimits_{jk}\)</span> is the effect of the <em>k</em>th block within the <em>j</em>th environment; and <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk}\)</span> is the random error. In a mixed-effect model assuming <span class="math inline">\({\alpha _i}\)</span> and <span class="math inline">\(\mathop {(\alpha \tau )}\nolimits_{ij}\)</span> to be random effects, the above model can be rewritten as follows</p>
<p><span class="math display">\[
{\boldsymbol{y  = X\beta  + Zu + \varepsilon }}
\]</span></p>
<p>where <strong>y </strong> is an <span class="math inline">\(n[ = \sum\nolimits_{j = 1}^e {(gb)]} \times 1\)</span> vector of response variable <span class="math inline">\({\bf{y}} = {\rm{ }}{\left[ {{y_{111}},{\rm{ }}{y_{112}},{\rm{ }} \ldots ,{\rm{ }}{y_{geb}}} \right]^\prime }\)</span>; <span class="math inline">\({\bf{\beta }}\)</span> is an <span class="math inline">\((eb) \times 1\)</span> vector of unknown fixed effects <span class="math inline">\({\boldsymbol{\beta }} = [\mathop \gamma \nolimits_{11} ,\mathop \gamma \nolimits_{12} ,...,\mathop \gamma \nolimits_{eb} ]'\)</span>; <strong>u</strong> is an <span class="math inline">\(m[ = g + ge] \times 1\)</span> vector of random effects <span class="math inline">\({\boldsymbol{u}} = {\rm{ }}{\left[ {{\alpha _1},{\alpha _2},...,{\alpha _g},\mathop {(\alpha \tau )}\nolimits_{11} ,\mathop {(\alpha \tau )}\nolimits_{12} ,...,\mathop {(\alpha \tau )}\nolimits_{ge} } \right]^\prime }\)</span>; <strong>X </strong> is an <span class="math inline">\(n \times (eb)\)</span> design matrix relating <strong>y</strong> to <span class="math inline">\({\bf{\beta }}\)</span>; <strong>Z </strong> is an <span class="math inline">\(n \times m\)</span> design matrix relating <strong>y</strong> to <strong>u </strong>; <span class="math inline">\({\boldsymbol{\varepsilon }}\)</span> is an <span class="math inline">\(n \times 1\)</span> vector of random errors <span class="math inline">\({\boldsymbol{\varepsilon }} = {\rm{ }}{\left[ {{y_{111}},{\rm{ }}{y_{112}},{\rm{ }} \ldots ,{\rm{ }}{y_{geb}}} \right]^\prime }\)</span>;</p>
<p>The vectors <span class="math inline">\({\boldsymbol{\beta }}\)</span> and <strong>u</strong> are estimated using the well-known mixed model equation <span class="citation">(Henderson <a href="#ref-Henderson1975" role="doc-biblioref">1975</a>)</span>. <span class="math display">\[
    \left[ {\begin{array}{*{20}{c}}{{\boldsymbol{\hat \beta }}}\\{{\bf{\hat u}}}\end{array}} \right]{\bf{ = }}{\left[ {\begin{array}{*{20}{c}}{{\bf{X'}}{{\bf{r }}^{ - {\bf{1}}}}{\bf{X}}}&amp;{{\bf{X'}}{{\bf{r }}^{ - {\bf{1}}}}{\bf{Z}}}\\{{\bf{Z'}}{{\bf{r }}^{ - {\bf{1}}}}{\bf{X}}}&amp;{{\bf{Z'}}{{\bf{r }}^{ - {\bf{1}}}}{\bf{Z + }}{{\bf{G}}^{ - {\bf{1}}}}}\end{array}} \right]^ - }\left[ {\begin{array}{*{20}{c}}{{\bf{X'}}{{\bf{r }}^{ - {\bf{1}}}}{\bf{y}}}\\{{\bf{Z'}}{{\bf{r }}^{ - {\bf{1}}}}{\bf{y}}}\end{array}} \right]
    \]</span> where <strong>G</strong> and <strong>R</strong> are the variance-covariance matrices for random-effect vector <strong>u</strong> and residual vector <span class="math inline">\({\bf{\varepsilon }}\)</span>, respectively.</p>
<p>The function <code><a href="../reference/gamem_met.html">gamem_met()</a></code> is used to fit the linear mixed-effect model. The first argument is the data, in our example <code>data_ge</code>. The arguments (<code>env</code>, <code>gen</code>, and <code>rep</code>) are the name of the columns that contains the levels for environments, genotypes, and replications, respectively.The argument (<code>resp</code>) is the response variable to be analyzed. The function allow a single variable (in this case GY) or a vector of response variables. Here, we will use <code><a href="https://tidyselect.r-lib.org/reference/select_helpers.html">everything()</a></code> to analyse all numeric variables in the data. By default, genotype and genotype-vs-environment interaction are assumed to be random effects. Other effects may be considered using the <code>random</code> argument. The last argument (<code>verbose</code>) control if the code is run silently or not.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">mixed_mod &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/gamem_met.html">gamem_met</a></span>(data_ge,</a>
<a class="sourceLine" id="cb11-3" title="3">            <span class="dt">env =</span> ENV,</a>
<a class="sourceLine" id="cb11-4" title="4">            <span class="dt">gen =</span> GEN,</a>
<a class="sourceLine" id="cb11-5" title="5">            <span class="dt">rep =</span> REP,</a>
<a class="sourceLine" id="cb11-6" title="6">            <span class="dt">resp =</span> <span class="kw"><a href="https://tidyselect.r-lib.org/reference/select_helpers.html">everything</a></span>(),</a>
<a class="sourceLine" id="cb11-7" title="7">            <span class="dt">random =</span> <span class="st">"gen"</span>, <span class="co">#Default</span></a>
<a class="sourceLine" id="cb11-8" title="8">            <span class="dt">verbose =</span> <span class="ot">TRUE</span>) <span class="co">#Default</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co"># Model:  Y ~ ENV/REP + (1 | GEN) + (1 | GEN:ENV) </span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co">#     model       GY       HM</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co">#  COMPLETE       NA       NA</span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co">#       GEN 1.11e-05 5.07e-03</span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">#   GEN:ENV 2.15e-11 2.27e-15</span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span></a></code></pre></div>
<div id="diagnostic-plot-for-residuals" class="section level2">
<h2 class="hasAnchor">
<a href="#diagnostic-plot-for-residuals" class="anchor"></a>Diagnostic plot for residuals</h2>
<p>The S3 generic function <code><a href="https://rdrr.io/r/graphics/plot.html">plot()</a></code> is used to generate diagnostic plots of residuals of the model.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(mixed_mod)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co"># `geom_smooth()` using formula 'y ~ x'</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co"># `geom_smooth()` using formula 'y ~ x'</span></a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The normality of the random effects of genotype and interaction effects may be also obtained by using <code>type = "re"</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(mixed_mod, <span class="dt">type =</span> <span class="st">"re"</span>)</a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-11-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="printing-the-model-outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#printing-the-model-outputs" class="anchor"></a>Printing the model outputs</h2>
<div id="likelihood-ratio-tests" class="section level3">
<h3 class="hasAnchor">
<a href="#likelihood-ratio-tests" class="anchor"></a>Likelihood Ratio Tests</h3>
<p>The output <code>LRT</code> contains the Likelihood Ratio Tests for genotype and genotype-vs-environment random effects. We can get these values with <code><a href="../reference/get_model_data.html">get_model_data()</a></code></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(mixed_mod, <span class="st">"pval_lrt"</span>)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">print_table</span>(data)</a></code></pre></div>
<div id="htmlwidget-122b7270a2c018da8bc5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-122b7270a2c018da8bc5">{"x":{"filter":"none","extensions":["Buttons"],"data":[["COMPLETE","GEN","GEN:ENV"],[null,1.10806828896706e-005,2.14686334967825e-011],[null,0.00506777438811823,2.26615242122161e-015]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>model<\/th>\n      <th>GY<\/th>\n      <th>HM<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<div id="variance-components-and-genetic-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#variance-components-and-genetic-parameters" class="anchor"></a>Variance components and genetic parameters</h3>
<p>In the output <code>ESTIMATES</code>, beyond the variance components for the declared random effects, some important parameters are also shown. <strong>Heribatility</strong> is the broad-sense heritability, <span class="math inline">\(\mathop h\nolimits_g^2\)</span>, estimated by <span class="math display">\[
\mathop h\nolimits_g^2  = \frac{\mathop {\hat\sigma} \nolimits_g^2} {\mathop {\hat\sigma} \nolimits_g^2  + \mathop {\hat\sigma} \nolimits_i^2  + \mathop {\hat\sigma} \nolimits_e^2 }
\]</span></p>
<p>where <span class="math inline">\(\mathop {\hat\sigma} \nolimits_g^2\)</span> is the genotypic variance; <span class="math inline">\(\mathop {\hat\sigma} \nolimits_i^2\)</span> is the genotype-by-environment interaction variance; and <span class="math inline">\(\mathop {\hat\sigma} \nolimits_e^2\)</span> is the residual variance.</p>
<p><strong>GEIr2</strong> is the coefficient of determination of the interaction effects, <span class="math inline">\(\mathop r\nolimits_i^2\)</span>, estimated by</p>
<p><span class="math display">\[
\mathop r\nolimits_i^2  = \frac{\mathop {\hat\sigma} \nolimits_i^2}
{\mathop {\hat\sigma} \nolimits_g^2  + \mathop {\hat\sigma} \nolimits_i^2  + \mathop {\hat\sigma} \nolimits_e^2 }
\]</span> <strong>Heribatility of means</strong> is the heribability on the mean basis, <span class="math inline">\(\mathop h\nolimits_{gm}^2\)</span>, estimated by</p>
<p><span class="math display">\[
\mathop h\nolimits_{gm}^2  = \frac{\mathop {\hat\sigma} \nolimits_g^2}{[\mathop {\hat\sigma} \nolimits_g^2  + \mathop {\hat\sigma} \nolimits_i^2 /e + \mathop {\hat\sigma} \nolimits_e^2 /\left( {eb} \right)]}
\]</span></p>
<p>where <em>e</em> and <em>b</em> are the number of environments and blocks, respectively; <strong>Accuracy</strong> is the accuracy of selection, <em>Ac</em>, estimated by <span class="math display">\[
Ac = \sqrt{\mathop h\nolimits_{gm}^2}
\]</span></p>
<p><strong>rge</strong> is the genotype-environment correlation, <span class="math inline">\(\mathop r\nolimits_{ge}\)</span>, estimated by</p>
<p><span class="math display">\[
\mathop r\nolimits_{ge} = \frac{\mathop {\hat\sigma} \nolimits_g^2}{\mathop {\hat\sigma} \nolimits_g^2  + \mathop {\hat\sigma} \nolimits_i^2}
\]</span></p>
<p><strong>CVg</strong> and <strong>CVr</strong> are the the genotypic coefficient of variation and the residual coefficient of variation estimated, respectively, by <span class="math display">\[
CVg  = \left( {\sqrt {\mathop {\hat \sigma }\nolimits_g^2 } /\mu } \right) \times 100
\]</span> and <span class="math display">\[
CVr = \left( {\sqrt {\mathop {\hat \sigma }\nolimits_e^2 } /\mu } \right) \times 100
\]</span> where <span class="math inline">\(\mu\)</span> is the grand mean.</p>
<p><strong>CV ratio</strong> is the ratio between genotypic and residual coefficient of variation.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(mixed_mod)</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co"># Class of the model: waasb</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co"># Variable extracted: genpar</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="kw">print_table</span>(data)</a></code></pre></div>
<div id="htmlwidget-981cdc5b6f1a3e932566" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-981cdc5b6f1a3e932566">{"x":{"filter":"none","extensions":["Buttons"],"data":[["Phenotypic variance","Heritability","GEIr2","Heribatility of means","Accuracy","rge","CVg","CVr","CV ratio"],[0.181432000761447,0.15446682075728,0.312589081763876,0.815198214366765,0.902883278373659,0.369694636990873,6.25999359103654,11.6277882108668,0.538364947616284],[5.51914705329479,0.0887647617608941,0.396652462685796,0.686242077698142,0.828397294598517,0.435290961148844,1.45551599851862,3.50448584437937,0.415329398705672]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Parameters<\/th>\n      <th>GY<\/th>\n      <th>HM<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<div id="blup-for-genotypes" class="section level3">
<h3 class="hasAnchor">
<a href="#blup-for-genotypes" class="anchor"></a>BLUP for genotypes</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">print_table</span>(mixed_mod<span class="op">$</span>GY<span class="op">$</span>BLUPgen)</a></code></pre></div>
<div id="htmlwidget-020765b2c65df1aa82c3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-020765b2c65df1aa82c3">{"x":{"filter":"none","extensions":["Buttons"],"data":[[1,2,3,4,5,6,7,8,9,10],["G8","G3","G2","G7","G4","G1","G5","G6","G9","G10"],[3.00363750440917,2.95534410934744,2.74414697530864,2.740909329806,2.64191544091711,2.60367618165785,2.53734447971781,2.53403047619048,2.51019186067019,2.47122087301587],[0.268522852740003,0.229154163319976,0.0569866367721679,0.0543473139396587,-0.0263523275157887,-0.0575249033826435,-0.111598388360068,-0.114299958117959,-0.133733154923069,-0.165502234470979],[2.94276457584406,2.90339588642403,2.73122835987622,2.72858903704372,2.64788939558827,2.61671681972141,2.56264333474399,2.5599417649861,2.54050856818099,2.50873948863308],[2.83926061038585,2.79989192096583,2.62772439441802,2.62508507158551,2.54438543013006,2.51321285426321,2.45913936928578,2.45643779952789,2.43700460272278,2.40523552317487],[3.04626854130227,3.00689985188224,2.83473232533443,2.83209300250192,2.75139336104647,2.72022078517962,2.6661473002022,2.6634457304443,2.6440125336392,2.61224345409128]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Rank<\/th>\n      <th>GEN<\/th>\n      <th>Y<\/th>\n      <th>BLUPg<\/th>\n      <th>Predicted<\/th>\n      <th>LL<\/th>\n      <th>UL<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[0,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 5, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 6, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><p>The function <code><a href="../reference/get_model_data.html">get_model_data()</a></code> may be used to easily get the data from a model fitted with the function <code><a href="../reference/gamem_met.html">gamem_met()</a></code>, especially when more than one variables are used. The following code return the predicted mean of each genotype for five variables of the data <code>data_ge2</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(mixed_mod, <span class="dt">what =</span> <span class="st">"blupg"</span>)</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co"># Class of the model: waasb</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co"># Variable extracted: blupg</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co"># # A tibble: 10 x 3</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">#    gen      GY    HM</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">#    &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">#  1 G1     2.62  47.4</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">#  2 G10    2.51  48.4</span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co">#  3 G2     2.73  47.1</span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="co">#  4 G3     2.90  47.8</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="co">#  5 G4     2.65  48.0</span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="co">#  6 G5     2.56  48.9</span></a>
<a class="sourceLine" id="cb17-13" title="13"><span class="co">#  7 G6     2.56  48.5</span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="co">#  8 G7     2.73  48.0</span></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="co">#  9 G8     2.94  48.8</span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="co"># 10 G9     2.54  48.0</span></a></code></pre></div>
</div>
<div id="plotting-the-blup-for-genotypes" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-the-blup-for-genotypes" class="anchor"></a>Plotting the BLUP for genotypes</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb18-2" title="2">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_blup.html">plot_blup</a></span>(mixed_mod)</a>
<a class="sourceLine" id="cb18-3" title="3">b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_blup.html">plot_blup</a></span>(mixed_mod, </a>
<a class="sourceLine" id="cb18-4" title="4">               <span class="dt">col.shape  =</span>  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gray20"</span>, <span class="st">"gray80"</span>),</a>
<a class="sourceLine" id="cb18-5" title="5">               <span class="dt">plot_theme =</span> <span class="kw"><a href="../reference/themes.html">theme_metan</a></span>(<span class="dt">grid =</span> <span class="st">"y"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="st">  </span><span class="kw">coord_flip</span>()</a>
<a class="sourceLine" id="cb18-7" title="7"><span class="kw"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span>(a, b, <span class="dt">labels =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This output shows the predicted means for genotypes. <strong>BLUPg</strong> is the genotypic effect <span class="math inline">\((\hat{g}_{i})\)</span>, which considering balanced data and genotype as random effect is estimated by</p>
<p><span class="math display">\[
\hat{g}_{i} = h_g^2(\bar{y}_{i.}-\bar{y}_{..})
\]</span></p>
<p>where <span class="math inline">\(h_g^2\)</span> is the shrinkage effect for genotype. <strong>Predicted</strong> is the predicted mean estimated by <span class="math display">\[
\hat{g}_{i}+\mu
\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is the grand mean. <strong>LL</strong> and <strong>UL</strong> are the lower and upper limits, respectively, estimated by <span class="math display">\[
(\hat{g}_{i}+\mu)\pm{CI}
\]</span> with <span class="math display">\[
CI = t\times\sqrt{((1-Ac)\times{\mathop \sigma \nolimits_g^2)}}
\]</span></p>
<p>where <span class="math inline">\(t\)</span> is the Student’s <em>t</em> value for a two-tailed <em>t</em> test at a given probability error; <span class="math inline">\(Ac\)</span> is the accuracy of selection and <span class="math inline">\(\mathop \sigma \nolimits_g^2\)</span> is the genotypic variance.</p>
</div>
<div id="blup-for-genotypes-x-environment-combination" class="section level3">
<h3 class="hasAnchor">
<a href="#blup-for-genotypes-x-environment-combination" class="anchor"></a>BLUP for genotypes X environment combination</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">print_table</span>(mixed_mod<span class="op">$</span>GY<span class="op">$</span>BLUPint)</a></code></pre></div>
<div id="htmlwidget-964de52a0b2aba6a91eb" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-964de52a0b2aba6a91eb">{"x":{"filter":"none","extensions":["Buttons"],"data":[["E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14"],["G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10"],["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],[-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979,-0.0575249033826435,-0.0575249033826435,-0.0575249033826435,0.0569866367721679,0.0569866367721679,0.0569866367721679,0.229154163319976,0.229154163319976,0.229154163319976,-0.0263523275157887,-0.0263523275157887,-0.0263523275157887,-0.111598388360068,-0.111598388360068,-0.111598388360068,-0.114299958117959,-0.114299958117959,-0.114299958117959,0.0543473139396587,0.0543473139396587,0.0543473139396587,0.268522852740003,0.268522852740003,0.268522852740003,-0.133733154923069,-0.133733154923069,-0.133733154923069,-0.165502234470979,-0.165502234470979,-0.165502234470979],[-0.0620869966581213,-0.0620869966581213,-0.0620869966581213,0.20664048896589,0.20664048896589,0.20664048896589,0.0884704041958473,0.0884704041958473,0.0884704041958473,0.060087328840915,0.060087328840915,0.060087328840915,-0.14080424507284,-0.14080424507284,-0.14080424507284,-0.0673229532162322,-0.0673229532162322,-0.0673229532162322,0.126694214791742,0.126694214791742,0.126694214791742,0.070237194506285,0.070237194506285,0.070237194506285,-0.0389103210407146,-0.0389103210407146,-0.0389103210407146,-0.24300511531091,-0.24300511531091,-0.24300511531091,-0.052122353363498,-0.052122353363498,-0.052122353363498,-0.00375709971320731,-0.00375709971320731,-0.00375709971320731,0.126994421240516,0.126994421240516,0.126994421240516,0.0232564276051573,0.0232564276051573,0.0232564276051573,0.0457664474618462,0.0457664474618462,0.0457664474618462,0.143794305325693,0.143794305325693,0.143794305325693,-0.396368685656933,-0.396368685656933,-0.396368685656933,-0.00234977911147732,-0.00234977911147732,-0.00234977911147732,0.0310126413347128,0.0310126413347128,0.0310126413347128,0.0837736748772102,0.0837736748772102,0.0837736748772102,0.0468815627516119,0.0468815627516119,0.0468815627516119,0.285240935542353,0.285240935542353,0.285240935542353,-0.102756463086115,-0.102756463086115,-0.102756463086115,-0.117098962196887,-0.117098962196887,-0.117098962196887,-0.134795660597963,-0.134795660597963,-0.134795660597963,-0.328612423482229,-0.328612423482229,-0.328612423482229,-0.0110611391461983,-0.0110611391461983,-0.0110611391461983,-0.142099421982007,-0.142099421982007,-0.142099421982007,0.36689123823385,0.36689123823385,0.36689123823385,0.137410333963614,0.137410333963614,0.137410333963614,-0.0786925392075617,-0.0786925392075617,-0.0786925392075617,-0.0106394475691292,-0.0106394475691292,-0.0106394475691292,0.146382361361862,0.146382361361862,0.146382361361862,-0.221099971682818,-0.221099971682818,-0.221099971682818,-0.117681290626237,-0.117681290626237,-0.117681290626237,-0.100426066581171,-0.100426066581171,-0.100426066581171,-0.453141200963536,-0.453141200963536,-0.453141200963536,0.12368575322956,0.12368575322956,0.12368575322956,0.226230849538217,0.226230849538217,0.226230849538217,0.485381552500829,0.485381552500829,0.485381552500829,0.202482559785851,0.202482559785851,0.202482559785851,-0.089302743833902,-0.089302743833902,-0.089302743833902,-0.00828906800305235,-0.00828906800305235,-0.00828906800305235,-0.0647465259650711,-0.0647465259650711,-0.0647465259650711,-0.21035461995006,-0.21035461995006,-0.21035461995006,-0.144916419318999,-0.144916419318999,-0.144916419318999,0.0529654062400842,0.0529654062400842,0.0529654062400842,0.403667148978075,0.403667148978075,0.403667148978075,0.100366524344851,0.100366524344851,0.100366524344851,-0.241872262277772,-0.241872262277772,-0.241872262277772,0.129692166981044,0.129692166981044,0.129692166981044,-0.114050595728585,-0.114050595728585,-0.114050595728585,0.0588838977669423,0.0588838977669423,0.0588838977669423,0.0410147628495616,0.0410147628495616,0.0410147628495616,-0.0754277381365716,-0.0754277381365716,-0.0754277381365716,-0.136043151727012,-0.136043151727012,-0.136043151727012,-0.0329396634705512,-0.0329396634705512,-0.0329396634705512,-0.0150563030263762,-0.0150563030263762,-0.0150563030263762,0.152110458460931,0.152110458460931,0.152110458460931,-0.00818383396937589,-0.00818383396937589,-0.00818383396937589,-0.021354872640994,-0.021354872640994,-0.021354872640994,-0.0371456580355132,-0.0371456580355132,-0.0371456580355132,-0.0379411163284797,-0.0379411163284797,-0.0379411163284797,0.0116960130956785,0.0116960130956785,0.0116960130956785,-0.140616782338429,-0.140616782338429,-0.140616782338429,-0.0744809690618726,-0.0744809690618726,-0.0744809690618726,0.323641033449101,0.323641033449101,0.323641033449101,0.00278079112706072,0.00278079112706072,0.00278079112706072,-0.294530850198867,-0.294530850198867,-0.294530850198867,0.267952410932338,0.267952410932338,0.267952410932338,-0.131936419231002,-0.131936419231002,-0.131936419231002,-0.349462187098208,-0.349462187098208,-0.349462187098208,0.0541283789488759,0.0541283789488759,0.0541283789488759,-0.133540634260458,-0.133540634260458,-0.133540634260458,0.180801253777364,0.180801253777364,0.180801253777364,0.0747965416844272,0.0747965416844272,0.0747965416844272,-0.00467996717256099,-0.00467996717256099,-0.00467996717256099,0.0471556859019974,0.0471556859019974,0.0471556859019974,0.0526792526324708,0.0526792526324708,0.0526792526324708,0.210058094817128,0.210058094817128,0.210058094817128,-0.137350521542047,-0.137350521542047,-0.137350521542047,0.1592455737873,0.1592455737873,0.1592455737873,0.00504523644519789,0.00504523644519789,0.00504523644519789,0.442781236749067,0.442781236749067,0.442781236749067,0.22614449347159,0.22614449347159,0.22614449347159,0.0620837202055884,0.0620837202055884,0.0620837202055884,0.0185248162456753,0.0185248162456753,0.0185248162456753,-0.31697962382421,-0.31697962382421,-0.31697962382421,-0.624578335846738,-0.624578335846738,-0.624578335846738,0.1650834043086,0.1650834043086,0.1650834043086,0.121116805651258,0.121116805651258,0.121116805651258,0.0413548934331289,0.0413548934331289,0.0413548934331289,-0.0431271602333781,-0.0431271602333781,-0.0431271602333781,0.0117937827758522,0.0117937827758522,0.0117937827758522,0.0486015556441177,0.0486015556441177,0.0486015556441177,0.0938826710539293,0.0938826710539293,0.0938826710539293,0.135391890556976,0.135391890556976,0.135391890556976,0.0836150623529065,0.0836150623529065,0.0836150623529065,-0.19074195841036,-0.19074195841036,-0.19074195841036,-0.301887542824415,-0.301887542824415,-0.301887542824415,0.0286466672279729,0.0286466672279729,0.0286466672279729,0.0417446968971295,0.0417446968971295,0.0417446968971295,-0.0189325650747655,-0.0189325650747655,-0.0189325650747655,0.0179094888135392,0.0179094888135392,0.0179094888135392,0.0439966037079095,0.0439966037079095,0.0439966037079095,0.157304162240735,0.157304162240735,0.157304162240735,-0.0371601176403786,-0.0371601176403786,-0.0371601176403786,0.0297426933201712,0.0297426933201712,0.0297426933201712,-0.0696278542093988,-0.0696278542093988,-0.0696278542093988,-0.193623775282885,-0.193623775282885,-0.193623775282885,-0.133043775002322,-0.133043775002322,-0.133043775002322,0.209036475886371,0.209036475886371,0.209036475886371,-0.0467435678139551,-0.0467435678139551,-0.0467435678139551,-0.0349590485271018,-0.0349590485271018,-0.0349590485271018,0.122479506253609,0.122479506253609,0.122479506253609,-0.0692118288007808,-0.0692118288007808,-0.0692118288007808,0.184127919208217,0.184127919208217,0.184127919208217,0.0784058434127101,0.0784058434127101,0.0784058434127101,-0.041730134014749,-0.041730134014749,-0.041730134014749,-0.268361390601965,-0.268361390601965,-0.268361390601965,0.0931914863826405,0.0931914863826405,0.0931914863826405,0.039336020385124,0.039336020385124,0.039336020385124,0.210648891166005,0.210648891166005,0.210648891166005,-0.157852860041523,-0.157852860041523,-0.157852860041523,-0.146612252136583,-0.146612252136583,-0.146612252136583,0.0741789789485675,0.0741789789485675,0.0741789789485675,0.140189815596229,0.140189815596229,0.140189815596229,0.217955137158431,0.217955137158431,0.217955137158431,0.111414025887253,0.111414025887253,0.111414025887253,-0.582449243346127,-0.582449243346127,-0.582449243346127,-0.121834898383951,-0.121834898383951,-0.121834898383951,-0.262919496910565,-0.262919496910565,-0.262919496910565,0.0309675840147609,0.0309675840147609,0.0309675840147609,0.067430681992953,0.067430681992953,0.067430681992953,0.0726649882897618,0.0726649882897618,0.0726649882897618,0.0836686206112193,0.0836686206112193,0.0836686206112193,0.0637964290220362,0.0637964290220362,0.0637964290220362,-0.0373599129166994,-0.0373599129166994,-0.0373599129166994,-0.0512166268954299,-0.0512166268954299,-0.0512166268954299,0.154802631175941,0.154802631175941,0.154802631175941],[-0.119611900040765,-0.119611900040765,-0.119611900040765,0.263627125738058,0.263627125738058,0.263627125738058,0.317624567515824,0.317624567515824,0.317624567515824,0.0337350013251263,0.0337350013251263,0.0337350013251263,-0.252402633432908,-0.252402633432908,-0.252402633432908,-0.181622911334191,-0.181622911334191,-0.181622911334191,0.181041528731401,0.181041528731401,0.181041528731401,0.338760047246288,0.338760047246288,0.338760047246288,-0.172643475963783,-0.172643475963783,-0.172643475963783,-0.408507349781889,-0.408507349781889,-0.408507349781889,-0.109647256746141,-0.109647256746141,-0.109647256746141,0.0532295370589606,0.0532295370589606,0.0532295370589606,0.356148584560492,0.356148584560492,0.356148584560492,-0.00309589991063137,-0.00309589991063137,-0.00309589991063137,-0.065831940898222,-0.065831940898222,-0.065831940898222,0.0294943472077335,0.0294943472077335,0.0294943472077335,-0.342021371717275,-0.342021371717275,-0.342021371717275,0.266173073628526,0.266173073628526,0.266173073628526,-0.102720513588356,-0.102720513588356,-0.102720513588356,-0.0817285595937687,-0.0817285595937687,-0.0817285595937687,-0.0106433406310316,-0.0106433406310316,-0.0106433406310316,0.342227572314521,0.342227572314521,0.342227572314521,0.126397700233861,0.126397700233861,0.126397700233861,-0.143451289712675,-0.143451289712675,-0.143451289712675,-0.246394048958031,-0.246394048958031,-0.246394048958031,-0.442912381600188,-0.442912381600188,-0.442912381600188,0.0432861747934604,0.0432861747934604,0.0432861747934604,0.126423430757996,0.126423430757996,0.126423430757996,0.233158083310781,0.233158083310781,0.233158083310781,-0.0280919005073645,-0.0280919005073645,-0.0280919005073645,-0.136217442590205,-0.136217442590205,-0.136217442590205,0.0463471892030388,0.0463471892030388,0.0463471892030388,0.375536524681839,0.375536524681839,0.375536524681839,-0.247452299198606,-0.247452299198606,-0.247452299198606,-0.229279678986305,-0.229279678986305,-0.229279678986305,-0.21472602469913,-0.21472602469913,-0.21472602469913,-0.398793887023878,-0.398793887023878,-0.398793887023878,0.392208605969563,0.392208605969563,0.392208605969563,0.0924976946151482,0.0924976946151482,0.0924976946151482,0.31987931802985,0.31987931802985,0.31987931802985,0.144957656403208,0.144957656403208,0.144957656403208,-0.032316107061734,-0.032316107061734,-0.032316107061734,0.220865095316924,0.220865095316924,0.220865095316924,-0.0910988534808598,-0.0910988534808598,-0.0910988534808598,-0.321953008310128,-0.321953008310128,-0.321953008310128,-0.259216377436958,-0.259216377436958,-0.259216377436958,0.107312720179743,0.107312720179743,0.107312720179743,0.672190001718078,0.672190001718078,0.672190001718078,-0.0333666305782171,-0.0333666305782171,-0.0333666305782171,-0.407374496748751,-0.407374496748751,-0.407374496748751,0.0721672635984,0.0721672635984,0.0721672635984,-0.0570639589564169,-0.0570639589564169,-0.0570639589564169,0.288038061086919,0.288038061086919,0.288038061086919,0.0146624353337729,0.0146624353337729,0.0146624353337729,-0.18702612649664,-0.18702612649664,-0.18702612649664,-0.250343109844971,-0.250343109844971,-0.250343109844971,0.0214076504691075,0.0214076504691075,0.0214076504691075,0.253466549713627,0.253466549713627,0.253466549713627,0.0183773035378622,0.0183773035378622,0.0183773035378622,-0.173686068440355,-0.173686068440355,-0.173686068440355,-0.0788797760236375,-0.0788797760236375,-0.0788797760236375,0.0198409787366548,0.0198409787366548,0.0198409787366548,0.191213046991497,0.191213046991497,0.191213046991497,-0.0146563144201102,-0.0146563144201102,-0.0146563144201102,-0.252215170698497,-0.252215170698497,-0.252215170698497,-0.188780927179832,-0.188780927179832,-0.188780927179832,0.377988347388759,0.377988347388759,0.377988347388759,0.271303643867064,0.271303643867064,0.271303643867064,-0.428264005121936,-0.428264005121936,-0.428264005121936,0.102450176461359,0.102450176461359,0.102450176461359,-0.189461322613646,-0.189461322613646,-0.189461322613646,-0.29247555032604,-0.29247555032604,-0.29247555032604,0.283282542268852,0.283282542268852,0.283282542268852,-0.159892961776247,-0.159892961776247,-0.159892961776247,0.0692028654172955,0.0692028654172955,0.0692028654172955,-0.0395034164335319,-0.0395034164335319,-0.0395034164335319,0.0496673467670977,0.0496673467670977,0.0496673467670977,0.315678538642,0.315678538642,0.315678538642,-0.0810539022905978,-0.0810539022905978,-0.0810539022905978,0.0445558603461489,0.0445558603461489,0.0445558603461489,-0.19487542492469,-0.19487542492469,-0.19487542492469,0.216232210559467,0.216232210559467,0.216232210559467,0.234199399765174,0.234199399765174,0.234199399765174,0.416428909233278,0.416428909233278,0.416428909233278,0.114546105111521,0.114546105111521,0.114546105111521,-0.0522162379123707,-0.0522162379123707,-0.0522162379123707,0.0728721301853341,0.0728721301853341,0.0728721301853341,-0.048456771084207,-0.048456771084207,-0.048456771084207,-0.758311490769807,-0.758311490769807,-0.758311490769807,-0.000418830162378425,-0.000418830162378425,-0.000418830162378425,0.063591902268614,0.063591902268614,0.063591902268614,0.0983415302052968,0.0983415302052968,0.0983415302052968,0.186027003086598,0.186027003086598,0.186027003086598,-0.0145585447399365,-0.0145585447399365,-0.0145585447399365,-0.0629968327159505,-0.0629968327159505,-0.0629968327159505,-0.0204172870640298,-0.0204172870640298,-0.0204172870640298,0.189739204496635,0.189739204496635,0.189739204496635,0.352137915092909,0.352137915092909,0.352137915092909,-0.324475113333429,-0.324475113333429,-0.324475113333429,-0.467389777295394,-0.467389777295394,-0.467389777295394,-0.0288782361546706,-0.0288782361546706,-0.0288782361546706,0.0987313336692975,0.0987313336692975,0.0987313336692975,0.210221598245211,0.210221598245211,0.210221598245211,-0.00844283870224946,-0.00844283870224946,-0.00844283870224946,-0.0676017846521586,-0.0676017846521586,-0.0676017846521586,0.0430042041227758,0.0430042041227758,0.0430042041227758,0.0171871962992801,0.0171871962992801,0.0171871962992801,0.298265546060174,0.298265546060174,0.298265546060174,-0.203361009132467,-0.203361009132467,-0.203361009132467,-0.359126009753864,-0.359126009753864,-0.359126009753864,-0.190568678384966,-0.190568678384966,-0.190568678384966,0.266023112658539,0.266023112658539,0.266023112658539,0.182410595506021,0.182410595506021,0.182410595506021,-0.0613113760428904,-0.0613113760428904,-0.0613113760428904,0.0108811178935412,0.0108811178935412,0.0108811178935412,-0.18351178691874,-0.18351178691874,-0.18351178691874,0.238475233147875,0.238475233147875,0.238475233147875,0.346928696152713,0.346928696152713,0.346928696152713,-0.175463288937818,-0.175463288937818,-0.175463288937818,-0.433863625072944,-0.433863625072944,-0.433863625072944,0.035666582999997,0.035666582999997,0.035666582999997,0.0963226571572919,0.0963226571572919,0.0963226571572919,0.439803054485981,0.439803054485981,0.439803054485981,-0.184205187557311,-0.184205187557311,-0.184205187557311,-0.258210640496651,-0.258210640496651,-0.258210640496651,-0.0401209791693916,-0.0401209791693916,-0.0401209791693916,0.194537129535888,0.194537129535888,0.194537129535888,0.486477989898434,0.486477989898434,0.486477989898434,-0.0223191290358158,-0.0223191290358158,-0.0223191290358158,-0.747951477817105,-0.747951477817105,-0.747951477817105,-0.179359801766594,-0.179359801766594,-0.179359801766594,-0.205932860138397,-0.205932860138397,-0.205932860138397,0.260121747334737,0.260121747334737,0.260121747334737,0.0410783544771644,0.0410783544771644,0.0410783544771644,-0.0389334000703064,-0.0389334000703064,-0.0389334000703064,-0.0306313375067398,-0.0306313375067398,-0.0306313375067398,0.118143742961695,0.118143742961695,0.118143742961695,0.231162939823304,0.231162939823304,0.231162939823304,-0.184949781818498,-0.184949781818498,-0.184949781818498,-0.0106996032950382,-0.0106996032950382,-0.0106996032950382],[2.4575080999586,2.43714409995892,2.30856209995892,2.84074712573742,2.82038312573774,2.69180112573774,2.89474456751519,2.87438056751551,2.74579856751551,2.61085500132449,2.59049100132481,2.46190900132481,2.32471736656646,2.30435336656678,2.17577136656678,2.39549708866517,2.37513308866549,2.24655108866549,2.75816152873077,2.73779752873109,2.60921552873109,2.91588004724565,2.89551604724597,2.76693404724597,2.40447652403558,2.3841125240359,2.2555305240359,2.16861265021748,2.1482486502178,2.0196666502178,2.76599974325372,3.24182074325373,3.20311474325373,2.92887653705883,3.40469753705883,3.36599153705883,3.23179558456036,3.70761658456036,3.66891058456036,2.87255110008923,3.34837210008924,3.30966610008924,2.80981505910164,3.28563605910165,3.24693005910165,2.9051413472076,3.3809623472076,3.3422563472076,2.53362562828259,3.00944662828259,2.97074062828259,3.14182007362839,3.61764107362839,3.57893507362839,2.77292648641151,3.24874748641151,3.21004148641151,2.7939184404061,3.2697394404061,3.2310334404061,4.30495665936883,3.88915665936884,3.96695665936884,4.65782757231438,4.24202757231439,4.31982757231439,4.44199770023372,4.02619770023373,4.10399770023373,4.17214871028718,3.75634871028719,3.83414871028719,4.06920595104183,3.65340595104184,3.73120595104184,3.87268761839967,3.45688761839968,3.53468761839968,4.35888617479332,3.94308617479333,4.02088617479333,4.44202343075786,4.02622343075786,4.10402343075786,4.54875808331064,4.13295808331065,4.21075808331065,4.2875080994925,3.8717080994925,3.9495080994925,3.61375455740966,3.58808255740966,3.41532855740966,3.79631918920291,3.77064718920291,3.59789318920291,4.12550852468171,4.09983652468171,3.92708252468171,3.50251970080126,3.47684770080126,3.30409370080126,3.52069232101356,3.49502032101356,3.32226632101356,3.53524597530074,3.50957397530074,3.33681997530074,3.35117811297599,3.32550611297599,3.15275211297599,4.14218060596943,4.11650860596943,3.94375460596943,3.84246969461502,3.81679769461502,3.64404369461502,4.06985131802972,4.04417931802972,3.87142531802972,4.05015765640307,4.20595765640308,3.91025765640308,3.87288389293813,4.02868389293814,3.73298389293814,4.12606509531679,4.2818650953168,3.9861650953168,3.81410114651901,3.96990114651901,3.67420114651901,3.58324699168974,3.73904699168974,3.44334699168974,3.64598362256291,3.80178362256291,3.50608362256291,4.01251272017961,4.16831272017961,3.87261272017961,4.57739000171794,4.73319000171795,4.43749000171795,3.87183336942165,4.02763336942165,3.73193336942165,3.49782550325112,3.65362550325112,3.35792550325112,2.87926726359827,2.68483022656123,2.64204504137605,2.75003604104345,2.55559900400642,2.51281381882123,3.09513806108679,2.90070102404975,2.85791583886457,2.82176243533364,2.6273253982966,2.58454021311142,2.62007387350323,2.42563683646619,2.38285165128101,2.5567568901549,2.36231985311786,2.31953466793268,2.82850765046898,2.63407061343194,2.59128542824675,3.0605665497135,2.86612951267646,2.82334432749127,2.82547730353773,2.63104026650069,2.58825508131551,2.63341393155951,2.43897689452248,2.39619170933729,1.71880222397623,1.90229622397623,2.10895022397623,1.81752297873652,2.00101697873652,2.20767097873652,1.98889504699136,2.17238904699136,2.37904304699136,1.78302568557976,1.96651968557976,2.17317368557976,1.54546682930137,1.72896082930137,1.93561482930137,1.60890107282003,1.79239507282004,1.99904907282004,2.17567034738863,2.35916434738863,2.56581834738863,2.06898564386693,2.25247964386693,2.45913364386693,1.36941799487793,1.55291199487793,1.75956599487793,1.90013217646122,2.08362617646123,2.29028017646123,2.02598567738622,2.44081467738622,2.57394267738622,1.92297144967382,2.33780044967383,2.47092844967383,2.49872954226871,2.91355854226872,3.04668654226872,2.05555403822361,2.47038303822362,2.60351103822362,2.28464986541716,2.69947886541716,2.83260686541716,2.17594358356633,2.59077258356633,2.72390058356633,2.26511434676696,2.67994334676696,2.81307134676696,2.53112553864186,2.94595453864187,3.07908253864187,2.13439309770926,2.54922209770927,2.68235009770927,2.26000286034601,2.67483186034602,2.80795986034602,2.93882457507517,3.05512457507518,2.59122457507518,3.34993221055933,3.46623221055934,3.00233221055934,3.36789939976504,3.48419939976504,3.02029939976504,3.55012890923314,3.66642890923315,3.20252890923315,3.24824610511138,3.36454610511139,2.90064610511139,3.08148376208749,3.1977837620875,2.7338837620875,3.2065721301852,3.3228721301852,2.8589721301852,3.08524322891566,3.20154322891566,2.73764322891566,2.37538850923006,2.49168850923006,2.02778850923006,3.13328116983748,3.24958116983749,2.78568116983749,2.37895590226848,2.39374590226848,1.94370190226848,2.41370553020516,2.42849553020517,1.97845153020517,2.50139100308646,2.51618100308647,2.06613700308647,2.30080545525993,2.31559545525993,1.86555145525993,2.25236716728392,2.26715716728392,1.81711316728392,2.29494671293584,2.30973671293584,1.85969271293584,2.5051032044965,2.5198932044965,2.0698492044965,2.66750191509278,2.68229191509278,2.23224791509278,1.99088888666644,2.00567888666644,1.55563488666644,1.84797422270447,1.86276422270447,1.41272022270447,1.34053976384519,1.5330517638452,1.1445677638452,1.46814933366916,1.66066133366917,1.27217733366917,1.57963959824507,1.77215159824508,1.38366759824508,1.36097516129761,1.55348716129762,1.16500316129762,1.3018162153477,1.49432821534771,1.10584421534771,1.41242220412264,1.60493420412264,1.21645020412264,1.38660519629914,1.57911719629915,1.19063319629915,1.66768354606003,1.86019554606004,1.47171154606004,1.16605699086739,1.3585689908674,0.970084990867401,1.010291990246,1.202803990246,0.814319990246004,1.36176835865193,1.5286313216149,1.3634313216149,1.81836014969544,1.98522311265841,1.82002311265841,1.73474763254292,1.90161059550589,1.73641059550589,1.49102566099401,1.65788862395698,1.49268862395698,1.56321815493044,1.73008111789341,1.56488111789341,1.36882525011816,1.53568821308113,1.37048821308113,1.79081227018477,1.95767523314774,1.79247523314774,1.89926573318961,2.06612869615258,1.90092869615258,1.37687374809908,1.54373671106205,1.37853671106205,1.11847341196395,1.28533637492692,1.12013637492692,2.98587028670357,3.00525547188875,2.84476658299987,3.04652636086086,3.06591154604605,2.90542265715716,3.39000675818955,3.40939194337474,3.24890305448585,2.76599851614626,2.78538370133145,2.62489481244256,2.69199306320692,2.71137824839211,2.55088935950322,2.91008272453418,2.92946790971937,2.76897902083048,3.14474083323946,3.16412601842465,3.00363712953576,3.436681693602,3.45606687878719,3.2955779898983,2.92788457466775,2.94726975985294,2.78678087096405,2.20225222588646,2.22163741107165,2.06114852218276,1.66124019823327,1.66139205008512,1.48508834638142,1.63466713986147,1.63481899171332,1.45851528800962,2.1007217473346,2.10087359918646,1.92456989548275,1.88167835447703,1.88183020632888,1.70552650262518,1.80166659992956,1.80181845178141,1.62551474807771,1.80996866249312,1.81012051434498,1.63381681064128,1.95874374296156,1.95889559481341,1.78259189110971,2.07176293982317,2.07191479167502,1.89561108797132,1.65565021818136,1.65580207003322,1.47949836632952,1.82990039670482,1.83005224855668,1.65374854485298]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>ENV<\/th>\n      <th>GEN<\/th>\n      <th>REP<\/th>\n      <th>BLUPg<\/th>\n      <th>BLUPge<\/th>\n      <th>BLUPg+ge<\/th>\n      <th>Predicted<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 5, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 6, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><p>This output shows the predicted means for each genotype and environment combination. <strong>BLUPg</strong> is the genotypic effect described above. <strong>BLUPge</strong> is the genotypic effect of the <em>i</em>th genotype in the <em>j</em>th environment <span class="math inline">\((\hat{g}_{ij})\)</span>, which considering balanced data and genotype as random effect is estimated by <span class="math display">\[\hat{g}_{ij} = h_g^2(\bar{y}_{i.}-\bar{y}_{..})+h_{ge}^2(y_{ij}-\bar{y}_{i.}-\bar{y}_{.j}+\bar{y}_{..})\]</span> where <span class="math inline">\(h_{ge}^2\)</span> is the shrinkage effect for the genotype-by-environment interaction; <strong>BLUPg+ge</strong> is <span class="math inline">\(BLUP_g+BLUP_{ge}\)</span>; <strong>Predicted</strong> is the predicted mean (<span class="math inline">\(\hat{y}_{ij}\)</span>) estimated by <span class="math display">\[
\hat{y}_{ij} = \bar{y}_{.j}+BLUP_{g+ge}
\]</span></p>
</div>
<div id="some-useful-information" class="section level3">
<h3 class="hasAnchor">
<a href="#some-useful-information" class="anchor"></a>Some useful information</h3>
<p>The following pieces of information are provided in <code>Details</code> output. <strong>Nenv</strong>, the number of environments in the analysis; <strong>Ngen</strong> the number of genotypes in the analysis; <strong>mresp</strong> The value attributed to the highest value of the response variable after rescaling it; <strong>wresp</strong> The weight of the response variable for estimating the WAASBY index. <strong>Mean</strong> the grand mean; <strong>SE</strong> the standard error of the mean; <strong>SD</strong> the standard deviation. <strong>CV</strong> the coefficient of variation of the phenotypic means, estimating WAASB, <strong>Min</strong> the minimum value observed (returning the genotype and environment), <strong>Max</strong> the maximum value observed (returning the genotype and environment); <strong>MinENV</strong> the environment with the lower mean, <strong>MaxENV</strong> the environment with the larger mean observed, <strong>MinGEN</strong> the genotype with the lower mean, <strong>MaxGEN</strong> the genotype with the larger.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(mixed_mod, <span class="st">"details"</span>)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co"># Class of the model: waasb</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co"># Variable extracted: details</span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="kw">print_table</span>(data)</a></code></pre></div>
<div id="htmlwidget-758d151fbd1221d20b48" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-758d151fbd1221d20b48">{"x":{"filter":"none","extensions":["Buttons"],"data":[["Nenv","Ngen","Mean","SE","SD","CV","Min","Max","MinENV","MaxENV","MinGEN","MaxGEN"],["14","10","2.67","0.05","0.92","34.56","0.67 (G10 in E11)","5.09 (G8 in E5)","E11 (1.37)","E3 (4.06)","G10 (2.47) ","G8 (3) "],["14","10","48.09","0.21","4.37","9.09","38 (G2 in E14)","58 (G8 in E11)","E14 (41.03)","E11 (54.2)","G2 (46.66) ","G5 (49.3) "]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Parameters<\/th>\n      <th>GY<\/th>\n      <th>HM<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
<div id="the-waasb-object" class="section level2">
<h2 class="hasAnchor">
<a href="#the-waasb-object" class="anchor"></a>The WAASB object</h2>
<p>The function <code><a href="../reference/waasb.html">waasb()</a></code> function computes the Weighted Average of the Absolute Scores considering all possible IPCA from the Singular Value Decomposition of the BLUPs for genotype-vs-environment interaction effects obtained by an Linear Mixed-effect Model <span class="citation">(Olivoto et al. <a href="#ref-Olivoto2019" role="doc-biblioref">2019</a>)</span>, as follows:</p>
<p><span class="math display">\[
        WAASB_i  = 
        \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k = 1}^{p}EP_k
\]</span></p>
<p>where <span class="math inline">\(WAASB_i\)</span> is the weighted average of absolute scores of the <em>i</em>th genotype; <span class="math inline">\(IPCA_{ik}\)</span> is the scores of the <em>i</em>th genotype in the <em>k</em>th IPCA; and <span class="math inline">\(EP_k\)</span> is the explained variance of the <em>k</em>th PCA for <span class="math inline">\(k = 1,2,..,p\)</span>, <span class="math inline">\(p = min(g-1; e-1)\)</span>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">waasb_model &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/waasb.html">waasb</a></span>(data_ge,</a>
<a class="sourceLine" id="cb21-3" title="3">        <span class="dt">env =</span> ENV,</a>
<a class="sourceLine" id="cb21-4" title="4">        <span class="dt">gen =</span> GEN,</a>
<a class="sourceLine" id="cb21-5" title="5">        <span class="dt">rep =</span> REP,</a>
<a class="sourceLine" id="cb21-6" title="6">        <span class="dt">resp =</span> <span class="kw"><a href="https://tidyselect.r-lib.org/reference/select_helpers.html">everything</a></span>(),</a>
<a class="sourceLine" id="cb21-7" title="7">        <span class="dt">random =</span> <span class="st">"gen"</span>, <span class="co">#Default</span></a>
<a class="sourceLine" id="cb21-8" title="8">        <span class="dt">verbose =</span> <span class="ot">TRUE</span>) <span class="co">#Default</span></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="co"># Model:  Y ~ ENV/REP + (1 | GEN) + (1 | GEN:ENV) </span></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb21-11" title="11"><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></a>
<a class="sourceLine" id="cb21-12" title="12"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb21-13" title="13"><span class="co">#     model       GY       HM</span></a>
<a class="sourceLine" id="cb21-14" title="14"><span class="co">#  COMPLETE       NA       NA</span></a>
<a class="sourceLine" id="cb21-15" title="15"><span class="co">#       GEN 1.11e-05 5.07e-03</span></a>
<a class="sourceLine" id="cb21-16" title="16"><span class="co">#   GEN:ENV 2.15e-11 2.27e-15</span></a>
<a class="sourceLine" id="cb21-17" title="17"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb21-18" title="18"><span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span></a>
<a class="sourceLine" id="cb21-19" title="19"></a>
<a class="sourceLine" id="cb21-20" title="20">data &lt;-<span class="st"> </span>waasb_model<span class="op">$</span>GY<span class="op">$</span>model</a>
<a class="sourceLine" id="cb21-21" title="21"><span class="kw">print_table</span>(data)</a></code></pre></div>
<div id="htmlwidget-01a6688881a9f9fa80da" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-01a6688881a9f9fa80da">{"x":{"filter":"none","extensions":["Buttons"],"data":[["GEN","GEN","GEN","GEN","GEN","GEN","GEN","GEN","GEN","GEN","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV"],["G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","E1","E10","E11","E12","E13","E14","E2","E3","E4","E5","E6","E7","E8","E9"],[2.60367618165785,2.47122087301587,2.74414697530864,2.95534410934744,2.64191544091711,2.53734447971781,2.53403047619048,2.740909329806,3.00363750440917,2.51019186067019,2.52068333333333,2.17520933333333,1.36826466666667,1.60851234567901,2.90963086419753,1.78193333333333,3.179959,4.06433333333333,3.67527266666667,3.9105,2.66321358024691,1.988896,2.53637566666667,3.0566],[0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.235280455344237,0.215362880133794,0.100449634824963,0.210554174402954,0.613216224388283,-0.201399471342885,-0.159191686338613,0.0645996602260233,-0.252918681864587,0.434499848674864,0.0690070944596466,-0.172274663680277,-0.187688084650643,-0.537262707629357],[-0.0481609851734376,-0.420872278639965,0.153950135205963,-0.079255176871498,0.39282144514496,0.206126753002374,0.195427432748866,0.458015135415759,-0.166207885050172,-0.69184457578259,0.159212292420106,0.296502269084161,0.13881573427411,0.218358288493891,0.0889111592987433,0.0228057064617737,-0.171764652139554,-0.328586732186818,-0.628267373224668,-0.112394924113747,-0.14551848507726,0.170737745885223,-0.161263616646006,0.592182597862406],[-0.0313724078373111,-0.12800651563351,-0.58489903546911,0.187372233504893,-0.0722613702817006,0.193159481423601,0.444824639110857,-0.166288102977107,0.259224115682254,-0.101753037523312,-0.177820500558959,0.0965173466064996,0.127094088762708,-0.139353688760126,0.170267578688511,0.236277194904751,0.202885980843951,-0.596104358175643,0.00939780507592284,0.0817267565781956,-0.0232802399679839,-0.139528367887636,0.374605841428973,-0.123501053786932],[-0.0513453402559624,-0.266060784834425,0.376262793936027,0.138379250373499,0.112815771972094,0.145457979710285,0.192025951170717,-0.564892302083581,-0.136372462121735,0.0537291421332915,0.0743119421558963,0.0185732805500547,0.17808506415344,0.0527505692744178,0.102732298886168,-0.199884672290072,0.401758022746501,0.00551401167181063,0.125594828730617,-0.1953515319606,-0.0664316701949725,-0.498664473651961,-0.230015328301562,0.182371983534117],[0.145957584815017,0.116204584546442,0.0810184203323532,0.175421275708714,0.11303389550671,-0.365036587063808,-0.0684933652149128,-0.172461379929687,0.309799741630432,-0.335444170330643,0.153380513524845,0.0478871974234888,-0.00886764944576857,-0.171880153437187,0.0490674456817594,-0.0990951341536636,0.124485869601189,-0.170925857165956,0.293118535261797,0.334861819232941,0.0228747359612206,0.260143686965573,-0.221504377788475,0.182789275326066],[0.418772802010734,-0.0574583402043295,-0.201764260293614,-0.154525795811139,0.278896133614225,-0.0545602218967526,-0.0353105512819375,-0.103239483268077,-0.175311605551326,0.0845013226812395,-0.185299826118559,0.0507084251092772,0.0198051951484245,-0.335790294886789,-0.133515315473703,-0.0110508088187768,-0.00706714451862176,0.0359027010317949,-0.237556866864364,0.130478475358927,0.288780311911804,-0.150363362819525,-0.155854315495914,0.0265531124304799],[-0.116831603239912,-0.0479717778756913,-0.0975222581382318,0.370222621519392,0.126309246940225,-0.186518433542,-0.0179992449447185,0.0930066738754701,-0.221823514227272,0.0991282896341289,0.20948402387316,-0.191258799508059,-0.109749659285873,-0.141114518421397,0.259574470573474,0.165371466383455,0.0284309418055528,0.0184812593809763,-0.0362083495830866,-0.168572537065198,0.196304289450613,0.0303963953478873,0.00656795438480683,0.0612149507171739],[0.140024766259412,0.0622829582106359,0.0837344540016029,-0.0293860914940459,-0.223508677860112,-0.177965699399254,0.301924082425445,0.0558657575289601,-0.17067940535675,-0.0422921443166219,-0.0885365839223943,0.0894518371102406,0.115274267637657,-0.22116027568467,0.0989358744706639,-0.0880763718144938,0.00374034819305483,0.00458263305010607,-0.00811932073729565,-0.235007198790778,-0.151777915624144,0.175023760519826,-0.111373677013041,-0.14559827990385],[-0.165597941880337,0.00590763019944087,0.00161220820283854,-0.164689516322937,0.162553555056282,-0.155118618992756,0.140060831281216,0.00594387059519297,0.0692196934429648,0.1001082884198,0.132641539872557,-0.140795847296568,0.0737019267701226,-0.0254399240986551,-0.135849786497891,0.140756401332089,0.0402246695742767,-0.0494015313152721,-0.0821460652782346,0.0456781807356934,-0.129746298467434,-0.0199182472559715,-0.122949561630643,-0.11193425663377],[0.134109971386119,0.464587114623651,0.213820846360848,0.0988956307415148,0.247508181472643,0.217782395531234,0.172115805388576,0.319043944418745,0.26489659427105,0.371975692087751,0.179874571644853,0.19043836377342,0.116512912715261,0.188771859444171,0.283491383452744,0.135951846818437,0.180590277905147,0.212193093610642,0.320745778345849,0.241009069871572,0.0955179493244292,0.199672940704703,0.203367218342528,0.417132961203767],[24.8781313039281,0,51.2617537094098,90.929397728364,32.0603373066199,12.4195231333963,11.7970776025975,50.6536499591245,100,7.3196413027776,42.7444108124842,29.9304196752654,0,8.91103709570498,57.1708805709522,15.343402480105,67.1976331957915,100,85.5693339165694,94.2941611526709,48.0310063905487,23.0198637373974,43.3264558296364,62.6221191695661],[90.3704783412584,0,68.5731769306464,100,59.3612218820424,67.4898732867303,79.9776101237676,39.7994420487559,54.6062812928295,25.3250148329265,73.7709313295137,70.4863234168304,93.4720200813548,71.0044908740988,41.5532773082004,87.4278575313587,73.548396238222,63.7221087397542,29.9697399989773,54.7623353471674,100,67.615009395348,66.4663448425842,0],[50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50],[50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50],[6,10,3,2,5,7,8,4,1,9,9,10,14,13,6,12,4,1,3,2,7,11,8,5],[2,10,4,1,6,5,3,8,7,9,4,7,2,6,12,3,5,10,13,11,1,8,9,14],[5,10,3,1,4,7,2,6,9,8,10,9,3,8,14,7,4,1,11,12,2,5,6,13],[57.6243048225932,0,59.9174653200281,95.464698864182,45.7107795943311,39.9546982100633,45.8873438631825,45.2265460039402,77.3031406464147,16.3223280678521,58.257671070999,50.2083715460479,46.7360100406774,39.9577639849019,49.3620789395763,51.3856300057319,70.3730147170068,81.8610543698771,57.7695369577734,74.5282482499191,74.0155031952743,45.3174365663727,54.8964003361103,31.3110595847831],[4,10,3,1,6,8,5,7,2,9,5,9,11,13,10,8,4,1,6,2,3,12,7,14]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>type<\/th>\n      <th>Code<\/th>\n      <th>Y<\/th>\n      <th>PC1<\/th>\n      <th>PC2<\/th>\n      <th>PC3<\/th>\n      <th>PC4<\/th>\n      <th>PC5<\/th>\n      <th>PC6<\/th>\n      <th>PC7<\/th>\n      <th>PC8<\/th>\n      <th>PC9<\/th>\n      <th>WAASB<\/th>\n      <th>PctResp<\/th>\n      <th>PctWAASB<\/th>\n      <th>wRes<\/th>\n      <th>wWAASB<\/th>\n      <th>OrResp<\/th>\n      <th>OrWAASB<\/th>\n      <th>OrPC1<\/th>\n      <th>WAASBY<\/th>\n      <th>OrWAASBY<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 5, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 6, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 7, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 8, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 9, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 10, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 11, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 12, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 13, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 14, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 15, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 16, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 17, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 18, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 19, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 20, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 21, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><p>The output generated by the <code><a href="../reference/waasb.html">waasb()</a></code> function is very similar to those generated by the <code><a href="../reference/waas.html">waas()</a></code> function. The main difference here, is that the singular value decomposition is based on the BLUP for GEI effects matrix.</p>
</div>
<div id="eigenvalues-of-the-blup_gei-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#eigenvalues-of-the-blup_gei-matrix" class="anchor"></a>Eigenvalues of the BLUP_GEI matrix</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">data &lt;-<span class="st"> </span>waasb_model<span class="op">$</span>GY<span class="op">$</span>PCA</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">print_table</span>(data)</a></code></pre></div>
<div id="htmlwidget-1a6a0aa0c81ac8ba1edf" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1a6a0aa0c81ac8ba1edf">{"x":{"filter":"none","extensions":["Buttons"],"data":[["PC1","PC2","PC3","PC4","PC5","PC6","PC7","PC8","PC9"],[1.47221530417126,1.34670369365827,0.54787966400651,0.416662713834582,0.212617859607033,0.139725609071792,0.0791160479277331,0.0567336385068696,0.0194696423005458],[34.3083827171793,31.38347060906,12.7677420160199,9.70987314811426,4.95482887539459,3.25615394558375,1.84371378539862,1.32211598216436,0.453718921085203],[34.3083827171793,65.6918533262393,78.4595953422592,88.1694684903735,93.1242973657681,96.3804513113518,98.2241650967505,99.5462810789148,100]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>PC<\/th>\n      <th>Eigenvalue<\/th>\n      <th>Proportion<\/th>\n      <th>Accumulated<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[1,2,3]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw"><a href="../reference/plot_eigen.html">plot_eigen</a></span>(waasb_model, <span class="dt">size.lab =</span> <span class="dv">14</span>, <span class="dt">size.tex.lab =</span> <span class="dv">14</span>)</a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-21-1.png" width="528" style="display: block; margin: auto;"></p>
<p>The above output shows the eigenvalues and the proportion of variance explained by each principal component axis of the BLUP interaction effects matrix.</p>
<div id="phenotypic-means" class="section level3">
<h3 class="hasAnchor">
<a href="#phenotypic-means" class="anchor"></a>Phenotypic means</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">data &lt;-<span class="st"> </span>waasb_model<span class="op">$</span>GY<span class="op">$</span>MeansGxE</a>
<a class="sourceLine" id="cb24-2" title="2"><span class="kw">print_table</span>(data)</a></code></pre></div>
<div id="htmlwidget-b4cdb348f28cd5a44e95" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b4cdb348f28cd5a44e95">{"x":{"filter":"none","extensions":["Buttons"],"data":[["E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9"],["G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9"],[2.36578666666667,1.97407333333333,2.90174666666667,2.88858666666667,2.58856666666667,2.18826,2.3008,2.77372666666667,2.89936,2.32592666666667,2.30763333333333,1.53625333333333,2.29705333333333,2.33672666666667,2.16735333333333,2.13983333333333,2.20814666666667,2.44189333333333,2.57486666666667,1.74233333333333,1.35566666666667,0.8991,1.49072,1.56772666666667,1.37,1.32566666666667,1.50066666666667,1.36433333333333,1.68343333333333,1.12533333333333,1.34233333333333,1.02213580246914,1.99333333333333,1.76435802469136,1.52733333333333,1.689,1.38566666666667,1.95162962962963,2,1.40933333333333,2.99825925925926,1.83066666666667,3.02830864197531,3.46914814814815,2.63571604938272,2.5680987654321,2.91166666666667,3.18383950617284,3.51997530864198,2.95062962962963,1.53333333333333,1.85920987654321,1.42658024691358,2.05965432098765,1.86133333333333,1.7842962962963,1.79885185185185,1.93633333333333,1.99186419753086,1.56787654320988,3.04069,3.14584,3.23105333333333,3.60828,3.19008,3.14013666666667,3.29117333333333,2.61267666666667,3.44479666666667,3.09486333333333,4.08033333333333,4.11433333333333,4.56866666666667,4.13233333333333,3.85433333333333,3.74133333333333,3.43466666666667,4.10133333333333,4.11,4.506,3.49433333333333,4.271,3.71557333333333,4.134,3.30216666666667,3.37911333333333,3.40347333333333,3.01895333333333,4.13777333333333,3.89634,4.17053086419753,3.36566666666667,3.82743209876543,4.12665432098765,3.7826049382716,3.469,3.56892592592593,4.04791358024691,4.8120987654321,3.93417283950617,2.80908641975309,2.48487654320988,2.54133333333333,2.98471604938272,2.70118518518518,2.43332098765432,2.33555555555556,2.6659012345679,2.90812345679012,2.76803703703704,1.89788,2.24362666666667,1.98762666666667,2.15854666666667,1.98088666666667,1.65676666666667,1.75778666666667,2.55081333333333,2.26178,1.39324666666667,2.27193333333333,2.70031,2.04529666666667,2.85042,2.30059,2.70833,2.53938,2.58338333333333,2.87885333333333,2.48526,2.78366666666667,3.15,3.36333333333333,3.29366666666667,3.72466666666667,3.29966666666667,3.03966666666667,3.14,2.828,1.94333333333333],[0.235280455344237,0.235280455344237,0.235280455344237,0.235280455344237,0.235280455344237,0.235280455344237,0.235280455344237,0.235280455344237,0.235280455344237,0.235280455344237,0.215362880133794,0.215362880133794,0.215362880133794,0.215362880133794,0.215362880133794,0.215362880133794,0.215362880133794,0.215362880133794,0.215362880133794,0.215362880133794,0.100449634824963,0.100449634824963,0.100449634824963,0.100449634824963,0.100449634824963,0.100449634824963,0.100449634824963,0.100449634824963,0.100449634824963,0.100449634824963,0.210554174402954,0.210554174402954,0.210554174402954,0.210554174402954,0.210554174402954,0.210554174402954,0.210554174402954,0.210554174402954,0.210554174402954,0.210554174402954,0.613216224388283,0.613216224388283,0.613216224388283,0.613216224388283,0.613216224388283,0.613216224388283,0.613216224388283,0.613216224388283,0.613216224388283,0.613216224388283,-0.201399471342885,-0.201399471342885,-0.201399471342885,-0.201399471342885,-0.201399471342885,-0.201399471342885,-0.201399471342885,-0.201399471342885,-0.201399471342885,-0.201399471342885,-0.159191686338613,-0.159191686338613,-0.159191686338613,-0.159191686338613,-0.159191686338613,-0.159191686338613,-0.159191686338613,-0.159191686338613,-0.159191686338613,-0.159191686338613,0.0645996602260233,0.0645996602260233,0.0645996602260233,0.0645996602260233,0.0645996602260233,0.0645996602260233,0.0645996602260233,0.0645996602260233,0.0645996602260233,0.0645996602260233,-0.252918681864587,-0.252918681864587,-0.252918681864587,-0.252918681864587,-0.252918681864587,-0.252918681864587,-0.252918681864587,-0.252918681864587,-0.252918681864587,-0.252918681864587,0.434499848674864,0.434499848674864,0.434499848674864,0.434499848674864,0.434499848674864,0.434499848674864,0.434499848674864,0.434499848674864,0.434499848674864,0.434499848674864,0.0690070944596466,0.0690070944596466,0.0690070944596466,0.0690070944596466,0.0690070944596466,0.0690070944596466,0.0690070944596466,0.0690070944596466,0.0690070944596466,0.0690070944596466,-0.172274663680277,-0.172274663680277,-0.172274663680277,-0.172274663680277,-0.172274663680277,-0.172274663680277,-0.172274663680277,-0.172274663680277,-0.172274663680277,-0.172274663680277,-0.187688084650643,-0.187688084650643,-0.187688084650643,-0.187688084650643,-0.187688084650643,-0.187688084650643,-0.187688084650643,-0.187688084650643,-0.187688084650643,-0.187688084650643,-0.537262707629357,-0.537262707629357,-0.537262707629357,-0.537262707629357,-0.537262707629357,-0.537262707629357,-0.537262707629357,-0.537262707629357,-0.537262707629357,-0.537262707629357],[0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669,0.245945000946366,-0.818930152153435,0.118910936570486,0.0436567926537909,-0.242924538163417,-0.256344617403984,-0.0753219337691638,0.247269536314594,0.404208024539449,0.333530950465669],[2.42365271847897,1.78139507423955,2.92972408596838,2.89885825672112,2.53141127071329,2.12794712169215,2.28307822112538,2.83190435576352,2.99446224806744,2.40439998056363,2.36060075709165,1.35988617713716,2.32266233511256,2.34612871926999,2.11503640513929,2.08462621822242,2.19192511807289,2.49514601284339,2.66191807100467,1.81416351943938,1.38037175219875,0.816838765269036,1.5026645601552,1.57211197554637,1.34559831885146,1.29991694345909,1.49310060592524,1.38917146795947,1.72403588179164,1.15883639551043,1.39411807995613,0.849706640388784,2.01837052741041,1.77355014462566,1.47618455775812,1.63502557071986,1.36980731908747,2.00369326270335,2.08510768689395,1.47955966724646,3.14907672414676,1.32848541072541,3.10122675753754,3.49591920170821,2.48675078127888,2.41090408700537,2.86547803482712,3.33546919763792,3.7678422273175,3.15515621979082,1.48380014016331,2.02414197625366,1.4026316471514,2.05086186602666,1.91025820689566,1.83592396672305,1.81402164949349,1.88653337944037,1.91045691507607,1.5007035861096,3.0015376005528,3.27620687191484,3.21212370081657,3.60133020155731,3.22875156688326,3.18094459859503,3.30316395898833,2.57331341220058,3.38045010960863,3.04176797888258,4.09622129682876,4.06143072375538,4.57634827276628,4.13515354730533,3.83864049070741,3.72477355814827,3.42980089533761,4.1173068613635,4.13611170104588,4.52754598607495,3.43212924788279,4.47812273462181,3.68549853599664,4.12295838154757,3.36360682065152,3.44394767607023,3.42252365753772,2.95641424814338,4.03554157256773,3.81198379164718,4.27739392989107,3.00984163948072,3.87909888271109,4.14562319078936,3.67705426320019,3.35761830252935,3.53619855710133,4.15535215635751,4.98772709092766,4.07909198701189,2.82605836966527,2.42836455284437,2.54953903156554,2.98772867779718,2.68442166863358,2.4156313904269,2.33035780775706,2.68296458681736,2.93601667812086,2.79105303884104,1.85550990767812,2.38470758320654,1.96714132506108,2.15102570739488,2.02273640977846,1.70092834941619,1.7707627274745,2.50821505712636,2.1921451985156,1.33578773434823,2.22577238717631,2.85401343172034,2.02297850073774,2.84222614020482,2.34618404128253,2.75644283025106,2.55351702948132,2.53697378766999,2.8029883034071,2.42266021473539,2.65152958953032,3.58998063090528,3.29944692158473,3.27021150003908,3.85518096178996,3.43739106989934,3.08013433274737,3.00715129940537,2.61083410229042,1.76413959180795]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>ENV<\/th>\n      <th>GEN<\/th>\n      <th>Y<\/th>\n      <th>envPC1<\/th>\n      <th>genPC1<\/th>\n      <th>nominal<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 5, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><p>In this output, <em>Y</em> is the phenotypic mean for each genotype and environment combination (<span class="math inline">\(y_{ij}\)</span>), estimated by <span class="math inline">\(y_{ij} = \sum_k{y_{ij}}/B\)</span> with <span class="math inline">\(k = 1,2,...B\)</span>.</p>
</div>
</div>
<div id="biplots" class="section level2">
<h2 class="hasAnchor">
<a href="#biplots" class="anchor"></a>Biplots</h2>
<p>Provided that an object of class <code>waasb</code> is available in the global environment, the graphics may be obtained using the function <code><a href="../reference/plot_scores.html">plot_scores()</a></code>. To do that, we will revisit the previusly fitted model <code>WAASB</code> . Please, refer to <code><a href="../reference/plot_scores.html">?plot_scores</a></code> for more details. Four types of graphics can be generated: 1 = <span class="math inline">\(PC1 \times PC2\)</span>; 2 = <span class="math inline">\(GY \times PC1\)</span>; 3 = <span class="math inline">\(GY \times WAASB\)</span>; and 4 = a graphic with nominal yield as a function of the environment PCA1 scores.</p>
<div id="biplot-type-1-pc1-x-pc2" class="section level3">
<h3 class="hasAnchor">
<a href="#biplot-type-1-pc1-x-pc2" class="anchor"></a>biplot type 1: PC1 x PC2</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_scores.html">plot_scores</a></span>(waasb_model, <span class="dt">type =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb25-2" title="2">d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_scores.html">plot_scores</a></span>(waasb_model,</a>
<a class="sourceLine" id="cb25-3" title="3">                 <span class="dt">type =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb25-4" title="4">                 <span class="dt">col.gen =</span> <span class="st">"black"</span>,</a>
<a class="sourceLine" id="cb25-5" title="5">                 <span class="dt">col.env =</span> <span class="st">"red"</span>,</a>
<a class="sourceLine" id="cb25-6" title="6">                 <span class="dt">col.segm.env =</span> <span class="st">"red"</span>,</a>
<a class="sourceLine" id="cb25-7" title="7">                 <span class="dt">axis.expand =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb25-8" title="8"><span class="kw"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span>(c, d, <span class="dt">labels =</span> letters[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>])</a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-23-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-2-gy-x-pc1" class="section level3">
<h3 class="hasAnchor">
<a href="#biplot-type-2-gy-x-pc1" class="anchor"></a>biplot type 2: GY x PC1</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"></a>
<a class="sourceLine" id="cb26-2" title="2">e &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_scores.html">plot_scores</a></span>(waasb_model, <span class="dt">type =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-3" title="3">f &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_scores.html">plot_scores</a></span>(waasb_model,</a>
<a class="sourceLine" id="cb26-4" title="4">                 <span class="dt">type =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb26-5" title="5">                 <span class="dt">polygon =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb26-6" title="6">                 <span class="dt">col.segm.env =</span> <span class="st">"transparent"</span>,</a>
<a class="sourceLine" id="cb26-7" title="7">                 <span class="dt">plot_theme =</span> <span class="kw"><a href="../reference/themes.html">theme_metan_minimal</a></span>())</a>
<a class="sourceLine" id="cb26-8" title="8"><span class="kw"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span>(e, f, <span class="dt">labels =</span> letters[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>])</a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-24-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-3-gy-x-waasb" class="section level3">
<h3 class="hasAnchor">
<a href="#biplot-type-3-gy-x-waasb" class="anchor"></a>biplot type 3: GY x WAASB</h3>
<p>The quadrants proposed by <span class="citation">Olivoto et al. (<a href="#ref-Olivoto2019" role="doc-biblioref">2019</a>)</span> in the following biplot represent four classifications regarding the joint interpretation of mean performance and stability. The genotypes or environments included in quadrant I can be considered unstable genotypes or environments with high discrimination ability, and with productivity below the grand mean. In quadrant II are included unstable genotypes, although with productivity above the grand mean. The environments included in this quadrant deserve special attention since, in addition to providing high magnitudes of the response variable, they present a good discrimination ability. Genotypes within quadrant III have low productivity, but can be considered stable due to the lower values of WAASB. The lower this value, the more stable the genotype can be considered. The environments included in this quadrant can be considered as poorly productive and with low discrimination ability. The genotypes within the quadrant IV are highly productive and broadly adapted due to the high magnitude of the response variable and high stability performance (lower values of WAASB).</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"></a>
<a class="sourceLine" id="cb27-2" title="2">g &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_scores.html">plot_scores</a></span>(waasb_model, <span class="dt">type =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb27-3" title="3">h &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_scores.html">plot_scores</a></span>(waasb_model, <span class="dt">type =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb27-4" title="4">                 <span class="dt">x.lab =</span> <span class="st">"My customized x label"</span>,</a>
<a class="sourceLine" id="cb27-5" title="5">                 <span class="dt">size.shape =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb27-6" title="6">                 <span class="dt">size.tex.pa =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb27-7" title="7">                 <span class="dt">x.lim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.2</span>, <span class="fl">4.7</span>),</a>
<a class="sourceLine" id="cb27-8" title="8">                 <span class="dt">x.breaks =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1.5</span>, <span class="fl">4.5</span>, <span class="dt">by =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb27-9" title="9">                 <span class="dt">plot_theme =</span> <span class="kw"><a href="../reference/themes.html">theme_metan</a></span>(<span class="dt">color.background =</span> <span class="st">"white"</span>))</a>
<a class="sourceLine" id="cb27-10" title="10"><span class="kw"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span>(g, h, <span class="dt">labels =</span> letters[<span class="dv">7</span><span class="op">:</span><span class="dv">8</span>])</a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-25-1.png" width="960" style="display: block; margin: auto;"></p>
<p>To obtain the WAASB index for a set of variables, the function <code><a href="../reference/get_model_data.html">get_model_data()</a></code> is used, as shown bellow.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw"><a href="../reference/waasb.html">waasb</a></span>(data_ge2, ENV, GEN, REP,</a>
<a class="sourceLine" id="cb28-2" title="2">     <span class="dt">resp =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(PH, ED, TKW, NKR)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="st"> </span><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(<span class="dt">what =</span> <span class="st">"WAASB"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="st"> </span><span class="kw">print_table</span>()</a>
<a class="sourceLine" id="cb28-5" title="5"><span class="co"># Model:  Y ~ ENV/REP + (1 | GEN) + (1 | GEN:ENV) </span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb28-7" title="7"><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></a>
<a class="sourceLine" id="cb28-8" title="8"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="co">#     model       PH       ED      TKW     NKR</span></a>
<a class="sourceLine" id="cb28-10" title="10"><span class="co">#  COMPLETE       NA       NA       NA      NA</span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="co">#       GEN 9.39e-01 2.99e-01 1.00e+00 0.78738</span></a>
<a class="sourceLine" id="cb28-12" title="12"><span class="co">#   GEN:ENV 1.09e-13 1.69e-08 4.21e-10 0.00404</span></a>
<a class="sourceLine" id="cb28-13" title="13"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb28-14" title="14"><span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span></a>
<a class="sourceLine" id="cb28-15" title="15"><span class="co"># Class of the model: waasb</span></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="co"># Variable extracted: WAASB</span></a></code></pre></div>
<div id="htmlwidget-ff5bfd20d0d8f5032baf" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ff5bfd20d0d8f5032baf">{"x":{"filter":"none","extensions":["Buttons"],"data":[["H1","H10","H11","H12","H13","H2","H3","H4","H5","H6","H7","H8","H9"],[0.319031275823403,0.286695818126097,0.210462692875361,0.297796138221141,0.258073199584921,0.312142883845536,0.339685818174331,0.267689225911392,0.170660808195801,0.23150922312331,0.209359913502112,0.333588803336433,0.207501705255119],[0.695033781532737,0.878918368055822,0.578752376936799,0.343860958894093,0.757591356333631,0.989911006034597,0.363507285573851,0.321076747160976,0.465178571218779,0.527635874281487,0.301285467712943,0.640100125265371,0.912645790118884],[3.48752741794947,2.47331684042312,0.800911584454155,1.58895460004729,0.422977055168949,3.85709785319315,3.08013107827182,2.76878345690244,0.475699884046625,0.590983895038334,2.54962069809681,4.4956164357011,5.12698924613781],[0.545048417215357,0.29149615050203,0.532981793838298,0.432661099796259,0.547382571845615,0.270802042905105,0.171934340026679,0.615165969264815,0.5615487001608,1.06841100305975,0.368702821291831,0.611968776530086,0.63203704762913]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>gen<\/th>\n      <th>PH<\/th>\n      <th>ED<\/th>\n      <th>TKW<\/th>\n      <th>NKR<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<div id="biplot-type-4-nominal-yield-and-environment-ipca1" class="section level3">
<h3 class="hasAnchor">
<a href="#biplot-type-4-nominal-yield-and-environment-ipca1" class="anchor"></a>biplot type 4 : nominal yield and environment IPCA1</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">i &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_scores.html">plot_scores</a></span>(waasb_model, <span class="dt">type =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb29-2" title="2">j &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_scores.html">plot_scores</a></span>(waasb_model,</a>
<a class="sourceLine" id="cb29-3" title="3">                 <span class="dt">type =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb29-4" title="4">                 <span class="dt">size.tex.pa =</span> <span class="fl">1.5</span>,</a>
<a class="sourceLine" id="cb29-5" title="5">                 <span class="dt">color =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb29-6" title="6">                 <span class="dt">col.alpha.gen =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb29-7" title="7">                 <span class="dt">col.alpha.env =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb29-8" title="8">                 <span class="dt">plot_theme =</span> <span class="kw"><a href="../reference/themes.html">theme_metan</a></span>(<span class="dt">color.background =</span> <span class="st">"white"</span>))</a>
<a class="sourceLine" id="cb29-9" title="9"><span class="kw"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span>(i, j, <span class="dt">labels =</span> letters[<span class="dv">9</span><span class="op">:</span><span class="dv">10</span>])</a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-27-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="simultaneous-selection-for-mean-performance-and-stability" class="section level1">
<h1 class="hasAnchor">
<a href="#simultaneous-selection-for-mean-performance-and-stability" class="anchor"></a>Simultaneous selection for mean performance and stability</h1>
<p>The <strong>waasby</strong> index is used for genotype ranking considering both the stability (<strong>waasb</strong>) and mean performance (<strong>y</strong>) based on the following model <span class="citation">(Olivoto et al. <a href="#ref-Olivoto2019" role="doc-biblioref">2019</a>)</span>.</p>
<p><span class="math display">\[
waasby_i = \frac{{\left( {r {Y_i} \times {\theta _Y}} \right) + \left( {r {W_i} \times {\theta _W}} \right)}}{{{\theta _Y} + {\theta _W}}}
\]</span></p>
<p>where <span class="math inline">\(waasby_i\)</span> is the superiority index for the <em>i</em>-th genotype; <span class="math inline">\(rY_i\)</span> and <span class="math inline">\(rW_i\)</span> are the rescaled values (0-100) for the response variable (y) and the stability (WAAS or WAASB), respectively; <span class="math inline">\(\theta _Y\)</span> and <span class="math inline">\(\theta_W\)</span> are the weights for mean performance and stability, respectively.</p>
<p>This index was also already computed and stored into AMMI_model&gt;GY&gt;model. An intuitively plot may be obtained by running</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">i &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_waasby.html">plot_waasby</a></span>(waasb_model)</a>
<a class="sourceLine" id="cb30-2" title="2">j &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_waasby.html">plot_waasby</a></span>(waasb_model, <span class="dt">col.shape =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gray20"</span>, <span class="st">"gray80"</span>))</a>
<a class="sourceLine" id="cb30-3" title="3"><span class="kw"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span>(i, j, <span class="dt">labels =</span> letters[<span class="dv">9</span><span class="op">:</span><span class="dv">10</span>])</a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-28-1.png" width="960" style="display: block; margin: auto;"></p>
<p>In the following example, we will apply the function <code><a href="../reference/wsmp.html">wsmp()</a></code> to the previously fitted model <strong>waasb_model</strong> aiming at planning different scenarios of <strong>waasby</strong> estimation by changing the weights assigned to the stability and the mean performance.vThe number of scenarios is defined by the arguments <code>increment</code>. By default, twenty-one different scenarios are computed. In this case, the the superiority index <strong>waasby</strong> is computed considering the following weights: stability (waasb or waas) = 100; mean performance = 0. In other words, only stability is considered for genotype ranking. In the next iteration, the weights becomes 95/5 (since increment = 5). In the third scenario, the weights become 90/10, and so on up to these weights become 0/100. In the last iteration, the genotype ranking for WAASY or WAASBY matches perfectly with the ranks of the response variable.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">scenarios &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wsmp.html">wsmp</a></span>(waasb_model)</a></code></pre></div>
<div id="printing-the-model-outputs-1" class="section level2">
<h2 class="hasAnchor">
<a href="#printing-the-model-outputs-1" class="anchor"></a>Printing the model outputs</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">print_table</span>(scenarios<span class="op">$</span>GY<span class="op">$</span>hetcomb)</a></code></pre></div>
<div id="htmlwidget-32f056ffbf15b8002c89" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-32f056ffbf15b8002c89">{"x":{"filter":"none","extensions":["Buttons"],"data":[[2,10,4,1,6,5,3,8,7,9],[2,10,4,1,6,5,3,8,7,9],[2,10,4,1,7,5,3,8,6,9],[2,10,4,1,7,6,3,8,5,9],[2,10,4,1,7,6,3,8,5,9],[2,10,4,1,7,6,5,8,3,9],[2,10,4,1,6,7,5,8,3,9],[3,10,4,1,6,7,5,8,2,9],[3,10,4,1,6,7,5,8,2,9],[3,10,4,1,6,8,5,7,2,9],[4,10,3,1,6,8,5,7,2,9],[4,10,3,1,6,8,7,5,2,9],[4,10,3,1,6,8,7,5,2,9],[4,10,3,1,6,8,7,5,2,9],[5,10,3,1,6,8,7,4,2,9],[5,10,3,1,6,8,7,4,2,9],[5,10,3,1,6,8,7,4,2,9],[6,10,3,2,5,8,7,4,1,9],[6,10,3,2,5,8,7,4,1,9],[6,10,3,2,5,8,7,4,1,9],[6,10,3,2,5,7,8,4,1,9]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>100/0<\/th>\n      <th>95/5<\/th>\n      <th>90/10<\/th>\n      <th>85/15<\/th>\n      <th>80/20<\/th>\n      <th>75/25<\/th>\n      <th>70/30<\/th>\n      <th>65/35<\/th>\n      <th>60/40<\/th>\n      <th>55/45<\/th>\n      <th>50/50<\/th>\n      <th>45/55<\/th>\n      <th>40/60<\/th>\n      <th>35/65<\/th>\n      <th>30/70<\/th>\n      <th>25/75<\/th>\n      <th>20/80<\/th>\n      <th>15/85<\/th>\n      <th>10/90<\/th>\n      <th>5/95<\/th>\n      <th>0/100<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 5, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 6, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 7, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 8, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 9, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 10, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 11, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 12, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 13, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 14, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 15, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 16, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 17, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 18, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 19, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 20, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><p>In addition, the genotype ranking depending on the number of multiplicative terms used to estimate the WAAS index is also computed.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">print_table</span>(scenarios<span class="op">$</span>GY<span class="op">$</span>hetdata)</a></code></pre></div>
<div id="htmlwidget-d21147c990ce775a3706" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d21147c990ce775a3706">{"x":{"filter":"none","extensions":["Buttons"],"data":[[2,10,4,1,6,5,3,8,7,9],[2,10,4,1,6,5,3,8,7,9],[2,10,4,1,6,5,3,8,7,9],[2,10,4,1,6,5,3,8,7,9],[2,10,4,1,6,5,3,8,7,9],[2,10,5,1,6,4,3,8,7,9],[2,10,4,1,6,5,3,8,7,9],[4,10,3,1,7,5,2,8,6,9],[5,10,3,1,4,7,2,6,9,8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>9PCA<\/th>\n      <th>8PCA<\/th>\n      <th>7PCA<\/th>\n      <th>6PCA<\/th>\n      <th>5PCA<\/th>\n      <th>4PCA<\/th>\n      <th>3PCA<\/th>\n      <th>2PCA<\/th>\n      <th>1PCA<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 5, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 6, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 7, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 8, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<div id="plotting-the-heat-map-graphics" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-the-heat-map-graphics" class="anchor"></a>Plotting the heat map graphics</h2>
<p>The first type of heatmap shows the genotype ranking depending on the number of principal component axes used for estimating the WAASB index. An euclidean distance-based dendrogram is used for grouping the genotypes based on their ranks. The second type of heatmap shows the genotype ranking depending on the WAASB/GY ratio. The ranks obtained with a ratio of 100/0 considers exclusively the stability for genotype ranking. On the other hand, a ratio of 0/100 considers exclusively the productivity for genotype ranking. Four clusters are estimated (1) unproductive and unstable genotypes; (2) productive, but unstable genotypes; (3) stable, but unproductive genotypes; and (4), productive and stable genotypes <span class="citation">(Olivoto et al. <a href="#ref-Olivoto2019" role="doc-biblioref">2019</a>)</span>.</p>
<div id="ranks-of-genotypes-depending-on-the-number-of-pca-used-to-estimate-the-waasb" class="section level3">
<h3 class="hasAnchor">
<a href="#ranks-of-genotypes-depending-on-the-number-of-pca-used-to-estimate-the-waasb" class="anchor"></a>Ranks of genotypes depending on the number of PCA used to estimate the WAASB</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(scenarios, <span class="dt">type =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-32-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
<div id="ranks-of-genotypes-depending-on-the-waasbgy-ratio" class="section level3">
<h3 class="hasAnchor">
<a href="#ranks-of-genotypes-depending-on-the-waasbgy-ratio" class="anchor"></a>Ranks of genotypes depending on the WAASB/GY ratio</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(scenarios, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-33-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="others-blup-based-stability-indexes" class="section level1">
<h1 class="hasAnchor">
<a href="#others-blup-based-stability-indexes" class="anchor"></a>Others BLUP-based stability indexes</h1>
<p><span class="citation">Colombari Filho et al. (<a href="#ref-ColombariFilho2013" role="doc-biblioref">2013</a>)</span> have shown the use of three BLUP-based indexes for selecting genotypes with performance and stability. The first is the harmonic mean of genotypic values -or BLUPS- (HMGV) a stability index that considers the genotype with the highest harmonic mean across environments as the most stable, as follows:</p>
<p><span class="math display">\[
HMGV_i = \frac{1}{e}\sum\limits_{j = 1}^e {\frac{1}{{BLUP_{ij}}}}
\]</span></p>
<p>The second is the relative performance of genotypic values (RPGV), an adaptability index estimated as follows:</p>
<p><span class="math display">\[
RPGV_i = \frac{1}{e}{\sum\limits_{j = 1}^e {BLUP_{ij}} /\mathop \mu \nolimits_j }
\]</span></p>
<p>The third and last is the harmonic mean of relative performance of genotypic values (HMRPGV), a simultaneous selection index for stability, adaptability and mean performance, estimated as follows:</p>
<p><span class="math display">\[
HMRPGV_i = \frac{1}{e}\sum\limits_{j = 1}^e {\frac{1}{{BLUP_{ij}/{\mu _j}}}}
\]</span></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">Res_ind &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb36-2" title="2">data_ge <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="kw"><a href="../reference/waasb.html">waasb</a></span>(ENV, GEN, REP, <span class="dt">resp =</span> GY, <span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="kw"><a href="../reference/Resende_indexes.html">Resende_indexes</a></span>()</a>
<a class="sourceLine" id="cb36-5" title="5"></a>
<a class="sourceLine" id="cb36-6" title="6"><span class="kw">print_table</span>(Res_ind<span class="op">$</span>GY)</a></code></pre></div>
<div id="htmlwidget-bd2bb0ecb94637660e22" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-bd2bb0ecb94637660e22">{"x":{"filter":"none","extensions":["Buttons"],"data":[["G1","G10","G2","G3","G4","G5","G6","G7","G8","G9"],[2.60367618165785,2.47122087301587,2.74414697530864,2.95534410934744,2.64191544091711,2.53734447971781,2.53403047619048,2.740909329806,3.00363750440917,2.51019186067019],[2.31606937506794,2.11186217488498,2.46616589232952,2.68077215809466,2.3876407373244,2.30179051137446,2.30440914480692,2.5199052050383,2.74012808539662,2.17660146641992],[6,10,4,2,5,8,7,3,1,9],[0.968978282653404,0.912983981030731,1.02529598669853,1.10500459689122,0.990470649507599,0.95423948789896,0.95420968962747,1.03689792893,1.12574854280151,0.926170853960536],[2.59128215225345,2.44153985459802,2.74188930616036,2.95504939722829,2.6487579364232,2.55186705237285,2.55178736459195,2.77291570414479,3.01052372288339,2.47680474038418],[6,10,4,2,5,7,8,3,1,9],[0.966717021963654,0.896426194887023,1.01970096165802,1.10396153507584,0.98818762291862,0.951986996050914,0.952064486779645,1.03083588901469,1.1221808761533,0.917244319410188],[2.5852349945701,2.39726033205029,2.72692685675521,2.95225999780181,2.64265257146399,2.54584334469185,2.54605057363178,2.75670434407616,3.00098291987862,2.45293302924691],[6,10,4,2,5,8,7,3,1,9]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>GEN<\/th>\n      <th>Y<\/th>\n      <th>HMGV<\/th>\n      <th>HMGV_R<\/th>\n      <th>RPGV<\/th>\n      <th>RPGV_Y<\/th>\n      <th>RPGV_R<\/th>\n      <th>HMRPGV<\/th>\n      <th>HMRPGV_Y<\/th>\n      <th>HMRPGV_R<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 0, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 1, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 2, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 3, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 4, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 5, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 6, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 7, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 8, 3, 3, \",\", \".\");\nDTWidget.formatSignif(this, row, data, 9, 3, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<div id="fai-blup-selection-index" class="section level1">
<h1 class="hasAnchor">
<a href="#fai-blup-selection-index" class="anchor"></a>FAI-BLUP selection index</h1>
<p>The FAI-BLUP is a multi-trait index based on factor analysis and ideotype-design recentely proposed by <span class="citation">Rocha, Machado, and Carneiro (<a href="#ref-Rocha2018" role="doc-biblioref">2018</a>)</span>. It is based on factor analysis, when the factorial scores of each ideotype are designed according to the desirable and undesirable factors. Then, a spatial probability is estimated based on genotype-ideotype distance, enabling genotype ranking <span class="citation">(Rocha, Machado, and Carneiro <a href="#ref-Rocha2018" role="doc-biblioref">2018</a>)</span>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">data_ge2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/gamem_met.html">gamem_met</a></span>(ENV, GEN, REP, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(KW, NKE, PH, EH)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/fai_blup.html">fai_blup</a></span>(<span class="dt">DI =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"max, max, max, min"</span>),</a>
<a class="sourceLine" id="cb37-4" title="4">           <span class="dt">UI =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"min, min, min, max"</span>),</a>
<a class="sourceLine" id="cb37-5" title="5">           <span class="dt">SI =</span> <span class="dv">15</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-6" title="6"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>()</a>
<a class="sourceLine" id="cb37-7" title="7"><span class="co"># Model:  Y ~ ENV/REP + (1 | GEN) + (1 | GEN:ENV) </span></a>
<a class="sourceLine" id="cb37-8" title="8"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-9" title="9"><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></a>
<a class="sourceLine" id="cb37-10" title="10"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-11" title="11"><span class="co">#     model       KW     NKE       PH       EH</span></a>
<a class="sourceLine" id="cb37-12" title="12"><span class="co">#  COMPLETE       NA      NA       NA       NA</span></a>
<a class="sourceLine" id="cb37-13" title="13"><span class="co">#       GEN 6.21e-01 1.00000 9.39e-01 1.00e+00</span></a>
<a class="sourceLine" id="cb37-14" title="14"><span class="co">#   GEN:ENV 4.92e-07 0.00101 1.09e-13 8.12e-12</span></a>
<a class="sourceLine" id="cb37-15" title="15"><span class="co"># ---------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-16" title="16"><span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span></a>
<a class="sourceLine" id="cb37-17" title="17"><span class="co"># </span></a>
<a class="sourceLine" id="cb37-18" title="18"><span class="co"># -----------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-19" title="19"><span class="co"># Principal Component Analysis</span></a>
<a class="sourceLine" id="cb37-20" title="20"><span class="co"># -----------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-21" title="21"><span class="co">#     eigen.values cumulative.var</span></a>
<a class="sourceLine" id="cb37-22" title="22"><span class="co"># PC1    3.1441417       78.60354</span></a>
<a class="sourceLine" id="cb37-23" title="23"><span class="co"># PC2    0.6604119       95.11384</span></a>
<a class="sourceLine" id="cb37-24" title="24"><span class="co"># PC3    0.1385777       98.57828</span></a>
<a class="sourceLine" id="cb37-25" title="25"><span class="co"># PC4    0.0568688      100.00000</span></a>
<a class="sourceLine" id="cb37-26" title="26"><span class="co"># </span></a>
<a class="sourceLine" id="cb37-27" title="27"><span class="co"># -----------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-28" title="28"><span class="co"># Factor Analysis</span></a>
<a class="sourceLine" id="cb37-29" title="29"><span class="co"># -----------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-30" title="30"><span class="co">#           FA1 comunalits</span></a>
<a class="sourceLine" id="cb37-31" title="31"><span class="co"># KW  0.9474560  0.8976729</span></a>
<a class="sourceLine" id="cb37-32" title="32"><span class="co"># NKE 0.7429933  0.5520391</span></a>
<a class="sourceLine" id="cb37-33" title="33"><span class="co"># PH  0.9429971  0.8892436</span></a>
<a class="sourceLine" id="cb37-34" title="34"><span class="co"># EH  0.8973216  0.8051860</span></a>
<a class="sourceLine" id="cb37-35" title="35"><span class="co"># </span></a>
<a class="sourceLine" id="cb37-36" title="36"><span class="co"># -----------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-37" title="37"><span class="co"># Comunalit Mean: 0.7860354 </span></a>
<a class="sourceLine" id="cb37-38" title="38"><span class="co"># </span></a>
<a class="sourceLine" id="cb37-39" title="39"><span class="co"># -----------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-40" title="40"><span class="co"># FAI-BLUP index</span></a>
<a class="sourceLine" id="cb37-41" title="41"><span class="co"># -----------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-42" title="42"><span class="co">#    H13     H6     H2     H5     H1     H4     H3     H8     H9    H10     H7 </span></a>
<a class="sourceLine" id="cb37-43" title="43"><span class="co"># 0.9807 0.8843 0.8413 0.8409 0.8023 0.7972 0.6222 0.2623 0.2354 0.1810 0.1163 </span></a>
<a class="sourceLine" id="cb37-44" title="44"><span class="co">#    H12    H11 </span></a>
<a class="sourceLine" id="cb37-45" title="45"><span class="co"># 0.1014 0.0780 </span></a>
<a class="sourceLine" id="cb37-46" title="46"><span class="co"># </span></a>
<a class="sourceLine" id="cb37-47" title="47"><span class="co"># -----------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-48" title="48"><span class="co"># Selection differential</span></a>
<a class="sourceLine" id="cb37-49" title="49"><span class="co"># -----------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-50" title="50"><span class="co">#     Factor         Xo         Xs           SD       SDperc</span></a>
<a class="sourceLine" id="cb37-51" title="51"><span class="co"># KW       1 172.938867 175.182040 2.243173e+00 1.297090e+00</span></a>
<a class="sourceLine" id="cb37-52" title="52"><span class="co"># NKE      1 511.643590 511.643590 2.819513e-07 5.510697e-08</span></a>
<a class="sourceLine" id="cb37-53" title="53"><span class="co"># PH       1   2.484813   2.487051 2.238030e-03 9.006835e-02</span></a>
<a class="sourceLine" id="cb37-54" title="54"><span class="co"># EH       1   1.343326   1.343326 3.234133e-10 2.407557e-08</span></a>
<a class="sourceLine" id="cb37-55" title="55"><span class="co"># </span></a>
<a class="sourceLine" id="cb37-56" title="56"><span class="co"># -----------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-57" title="57"><span class="co"># Selected genotypes</span></a>
<a class="sourceLine" id="cb37-58" title="58"><span class="co"># H13 H6</span></a>
<a class="sourceLine" id="cb37-59" title="59"><span class="co"># -----------------------------------------------------------------------------------</span></a></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-35-1.png" width="528" style="display: block; margin: auto;"></p>
<blockquote>
<ul>
<li>
<strong>IMPORTANT</strong> <code><a href="../reference/fai_blup.html">fai_blup()</a></code> recognizes models fitted with both <code><a href="../reference/gamem_met.html">gamem_met()</a></code> and <code><a href="../reference/waasb.html">waasb()</a></code>. For balanced data (all genotypes in all environments) <code><a href="../reference/waasb.html">waasb()</a></code> and <code><a href="../reference/gamem_met.html">gamem_met()</a></code> will return the same model. In case of unbalanced trials, the function <code><a href="../reference/waasb.html">waasb()</a></code> will return an error since a complete two-way table is required to the singular value decomposition procedure.</li>
</ul>
</blockquote>
<hr>
<p><strong>Rendering engine</strong></p>
<p>This vignette was built with <a href="https://pkgdown.r-lib.org/">pkgdown</a>. All tables were produced with the package <a href="https://rstudio.github.io/DT/"><code>DT</code></a> using the following function.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DT) <span class="co"># Used to make the tables</span></a>
<a class="sourceLine" id="cb38-2" title="2"><span class="co"># Function to make HTML tables</span></a>
<a class="sourceLine" id="cb38-3" title="3">print_table &lt;-<span class="st"> </span><span class="cf">function</span>(table, <span class="dt">rownames =</span> <span class="ot">FALSE</span>, ...){</a>
<a class="sourceLine" id="cb38-4" title="4"><span class="kw">datatable</span>(table, <span class="dt">rownames =</span> rownames, <span class="dt">extensions =</span> <span class="st">'Buttons'</span>,</a>
<a class="sourceLine" id="cb38-5" title="5">          <span class="dt">options =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">dom =</span> <span class="st">'&lt;&lt;t&gt;Bp&gt;'</span>, <span class="dt">buttons =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'copy'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>)), ...) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-6" title="6"><span class="st">    </span><span class="kw">formatSignif</span>(<span class="dt">columns =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(table)), <span class="dt">digits =</span> <span class="dv">3</span>)}</a></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-ColombariFilho2013">
<p>Colombari Filho, J. M., M. D. V. Resende, O. P. Morais, A. P. Castro, É. P. Guimarães, J. A. Pereira, M. M. Utumi, and F. Breseghello. 2013. “Upland rice breeding in Brazil: a simultaneous genotypic evaluation of stability, adaptability and grain yield.” <em>Euphytica</em> 192 (1): 117–29. <a href="https://doi.org/10.1007/s10681-013-0922-2">https://doi.org/10.1007/s10681-013-0922-2</a>.</p>
</div>
<div id="ref-Henderson1975">
<p>Henderson, C. R. 1975. “Best Linear Unbiased Estimation and Prediction under a Selection Model.” <em>Biometrics</em> 31 (2): 423–47. <a href="https://doi.org/10.2307/2529430">https://doi.org/10.2307/2529430</a>.</p>
</div>
<div id="ref-Olivoto2019">
<p>Olivoto, T., A. D. C Lúcio, J. A. G. Da silva, V. S. Marchioro, V. Q. de Souza, and E. Jost. 2019. “Mean performance and stability in multi-environment trials I: Combining features of AMMI and BLUP techniques.” <em>Agronomy Journal</em> 111 (6): 2949–60. <a href="https://doi.org/10.2134/agronj2019.03.0220">https://doi.org/10.2134/agronj2019.03.0220</a>.</p>
</div>
<div id="ref-Rocha2018">
<p>Rocha, João Romero do Amaral Santos de Car, Juarez Campolina Machado, and Pedro Crescêncio Souza Carneiro. 2018. “Multitrait index based on factor analysis and ideotype-design: proposal and application on elephant grass breeding for bioenergy.” <em>GCB Bioenergy</em> 10 (1): 52–60. <a href="https://doi.org/10.1111/gcbb.12443">https://doi.org/10.1111/gcbb.12443</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#getting-started">Getting started</a></li>
      <li><a href="#analysis-of-single-experiments-using-mixed-models">Analysis of single experiments using mixed-models</a></li>
      <li>
<a href="#the-blup-model-for-met-trials">The BLUP model for MET trials</a><ul class="nav nav-pills nav-stacked">
<li><a href="#diagnostic-plot-for-residuals">Diagnostic plot for residuals</a></li>
      <li>
<a href="#printing-the-model-outputs">Printing the model outputs</a><ul class="nav nav-pills nav-stacked">
<li><a href="#likelihood-ratio-tests">Likelihood Ratio Tests</a></li>
      <li><a href="#variance-components-and-genetic-parameters">Variance components and genetic parameters</a></li>
      <li><a href="#blup-for-genotypes">BLUP for genotypes</a></li>
      <li><a href="#plotting-the-blup-for-genotypes">Plotting the BLUP for genotypes</a></li>
      <li><a href="#blup-for-genotypes-x-environment-combination">BLUP for genotypes X environment combination</a></li>
      <li><a href="#some-useful-information">Some useful information</a></li>
      </ul>
</li>
      <li><a href="#the-waasb-object">The WAASB object</a></li>
      <li>
<a href="#eigenvalues-of-the-blup_gei-matrix">Eigenvalues of the BLUP_GEI matrix</a><ul class="nav nav-pills nav-stacked">
<li><a href="#phenotypic-means">Phenotypic means</a></li>
      </ul>
</li>
      <li>
<a href="#biplots">Biplots</a><ul class="nav nav-pills nav-stacked">
<li><a href="#biplot-type-1-pc1-x-pc2">biplot type 1: PC1 x PC2</a></li>
      <li><a href="#biplot-type-2-gy-x-pc1">biplot type 2: GY x PC1</a></li>
      <li><a href="#biplot-type-3-gy-x-waasb">biplot type 3: GY x WAASB</a></li>
      <li><a href="#biplot-type-4-nominal-yield-and-environment-ipca1">biplot type 4 : nominal yield and environment IPCA1</a></li>
      </ul>
</li>
      </ul>
</li>
      <li>
<a href="#simultaneous-selection-for-mean-performance-and-stability">Simultaneous selection for mean performance and stability</a><ul class="nav nav-pills nav-stacked">
<li><a href="#printing-the-model-outputs-1">Printing the model outputs</a></li>
      <li>
<a href="#plotting-the-heat-map-graphics">Plotting the heat map graphics</a><ul class="nav nav-pills nav-stacked">
<li><a href="#ranks-of-genotypes-depending-on-the-number-of-pca-used-to-estimate-the-waasb">Ranks of genotypes depending on the number of PCA used to estimate the WAASB</a></li>
      <li><a href="#ranks-of-genotypes-depending-on-the-waasbgy-ratio">Ranks of genotypes depending on the WAASB/GY ratio</a></li>
      </ul>
</li>
      </ul>
</li>
      <li><a href="#others-blup-based-stability-indexes">Others BLUP-based stability indexes</a></li>
      <li><a href="#fai-blup-selection-index">FAI-BLUP selection index</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'ef40e3bab94bb0e1d687fd3844052701',
    indexName: 'metan',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
