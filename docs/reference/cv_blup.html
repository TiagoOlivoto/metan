<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cross-validation procedure — cv_blup • metan</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Cross-validation procedure — cv_blup" />
<meta property="og:description" content="Cross-validation for blup prediction." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="../articles/vignettes_ammi.html">AMMI</a>
    </li>
    <li>
      <a href="../articles/vignettes_blup.html">BLUP</a>
    </li>
    <li>
      <a href="../articles/vignettes_gge.html">GGE</a>
    </li>
    <li>
      <a href="../articles/vignettes_stability.html">Stability</a>
    </li>
    <li>
      <a href="../articles/vignettes_indexes.html">Multivariate indexes</a>
    </li>
    <li>
      <a href="../articles/vignettes_biometry.html">Biometry</a>
    </li>
    <li>
      <a href="../articles/vignettes_helper.html">Helper</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    </li>
    <li>
      <a href="../CONTRIBUTING.html">Contributing</a>
    </li>
    <li>
      <a href="../ISSUE_TEMPLATE.html">Issues</a>
    </li>
    <li>
      <a href="../SUPPORT.html">Support</a>
    </li>
    <li>
      <a href="../LICENSE.html">Licence</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/TiagoOlivoto">Github</a>
</li>
<li>
  <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">ResearchGate</a>
</li>
<li>
  <a href="https://www.mendeley.com/profiles/tiago-olivoto/">Mendeley</a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cross-validation procedure</h1>
    <small class="dont-index">Source: <a href='https://github.com/TiagoOlivoto/metan/blob/master/R/cv_blup.R'><code>R/cv_blup.R</code></a></small>
    <div class="hidden name"><code>cv_blup.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Cross-validation for blup prediction.</p>
    </div>

    <pre class="usage"><span class='fu'>cv_blup</span>(<span class='no'>.data</span>, <span class='no'>env</span>, <span class='no'>gen</span>, <span class='no'>rep</span>, <span class='no'>resp</span>, <span class='kw'>block</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>nboot</span> <span class='kw'>=</span> <span class='fl'>200</span>,
  <span class='kw'>random</span> <span class='kw'>=</span> <span class='st'>"gen"</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.data</th>
      <td><p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p></td>
    </tr>
    <tr>
      <th>env</th>
      <td><p>The name of the column that contains the levels of the
environments.</p></td>
    </tr>
    <tr>
      <th>gen</th>
      <td><p>The name of the column that contains the levels of the genotypes.</p></td>
    </tr>
    <tr>
      <th>rep</th>
      <td><p>The name of the column that contains the levels of the
replications/blocks.</p></td>
    </tr>
    <tr>
      <th>resp</th>
      <td><p>The response variable.</p></td>
    </tr>
    <tr>
      <th>block</th>
      <td><p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed. See how
fixed and random effects are considered, see the section <strong>Details</strong>.</p></td>
    </tr>
    <tr>
      <th>nboot</th>
      <td><p>The number of resamples to be used in the cross-validation.
Defaults to 200</p></td>
    </tr>
    <tr>
      <th>random</th>
      <td><p>The effects of the model assumed to be random. See
<strong>Details</strong> for more information.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical argument to define if a progress bar is shown.
Default is <code>TRUE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>cv_blup</code> with the following items: *
<strong>RMSPD</strong>: A vector with nboot-estimates of the root mean squared
prediction difference between predicted and validating data. *
<strong>RMSPDmean</strong> The mean of RMSPDmean estimates.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function provides a cross-validation procedure for mixed models using
replicate-based data. By default, complete blocks are randomly selected
within each environment. In each iteration, the original dataset is split up
into two datasets: training and validation data. The 'training' set has all
combinations (genotype x environment) with R - 1 replications. The
'validation' set has the remaining replication. The estimated values are
compared with the 'validation' data and the Root Means Square Prediction
Difference (Olivoto et al. 2019) is computed. At the end of boots, a list is
returned.</p>
<p>Six models may be fitted depending upon the values in <code>block</code>
and <code>random</code> arguments. *  <strong>Model 1:</strong> <code>block = NULL</code> and
<code>random = "gen"</code> (The default option). This model considers a
Randomized Complete Block Design assuming genotype and
genotype-vs-environment as random effects. Environment and blocks nested
within environments are treated as fixed factors.</p><ul>
<li><p><strong>Model 2:</strong> <code>block = NULL</code> and <code>random = "env"</code>. This
model considers a Randomized Complete Block Design treating environment,
genotype-vs-environment, and blocks-within-environments as random factors.
Genotypes are assumed to be fixed factors.</p></li>
<li><p><strong>Model 3:</strong> <code>block = NULL</code> and <code>random = "all"</code>. This
model considers a Randomized Complete Block Design assuming all effects
(genotypes, environments, genotype-vs-environment interaction and blocks
nested within environments) as random.</p></li>
<li><p><strong>Model 4:</strong> <code>block != NULL</code> and <code>random = "gen"</code>. This
model considers an alpha-lattice design assuming genotype,
genotype-vs-environment interaction, and incomplete block nested within
replicates as random to make use of inter-block information (Mohring et
al., 2015). Complete replicates nested within environments and environments
are treated as fixed factors.</p></li>
<li><p><strong>Model 5:</strong> <code>block != NULL</code> and <code>random = "env"</code>. This
model considers an alpha-lattice design assuming genotype as fixed. All
other sources of variation (environment, complete replicates nested within
environments, and incomplete blocks nested within replicates) as treated as
random factors.</p></li>
<li><p><strong>Model 6:</strong> <code>block != NULL</code> and <code>random = "all"</code>. This
model considers an alpha-lattice design assuming all effects, except the
intercept, as random factors.</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Olivoto, T., A.D.C. L'ucio, J.A.G. da silva, V.S. Marchioro,
V.Q. de Souza, and E. Jost. 2019. Mean performance and stability in
multi-environment trials I: Combining features of AMMI and BLUP techniques.
Agron. J.
<a href='https://dl.sciencesocieties.org/publications/aj/abstracts/0/0/agronj2019.03.0220?access=0&amp;view=pdf'>doi:10.2134/agronj2019.03.0220</a></p>
<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.</p>
<p>Mohring, J., E. Williams, and H.-P. Piepho. 2015. Inter-block
information: to recover or not to recover it? TAG. Theor. Appl. Genet.
128:1541-54.
<a href='http://www.ncbi.nlm.nih.gov/pubmed/25972114'>doi:10.1007/s00122-015-2530-0</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='cv_ammi.html'>cv_ammi</a></code>, <code><a href='cv_ammif.html'>cv_ammif</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>metan</span>)
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'>cv_blup</span>(<span class='no'>data_ge</span>,
                 <span class='kw'>env</span> <span class='kw'>=</span> <span class='no'>ENV</span>,
                 <span class='kw'>gen</span> <span class='kw'>=</span> <span class='no'>GEN</span>,
                 <span class='kw'>rep</span> <span class='kw'>=</span> <span class='no'>REP</span>,
                 <span class='kw'>resp</span> <span class='kw'>=</span> <span class='no'>GY</span>,
                 <span class='kw'>nboot</span> <span class='kw'>=</span> <span class='fl'>10</span>)

<span class='co'># Alternatively using the pipe operator %&gt;%</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='no'>data_ge</span> <span class='kw'>%&gt;%</span>
         <span class='fu'>cv_blup</span>(<span class='no'>ENV</span>, <span class='no'>GEN</span>, <span class='no'>REP</span>, <span class='no'>GY</span>, <span class='kw'>nboot</span> <span class='kw'>=</span> <span class='fl'>10</span>)
<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Tiago Olivoto <a href='mailto:tiagoolivoto@gmail.com'>tiagoolivoto@gmail.com</a></p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.researchgate.net/profile/Tiago_Olivoto2'>Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


